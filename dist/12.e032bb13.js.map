{"version":3,"sources":["../node_modules/xstate/es/_virtual/_tslib.js","../node_modules/xstate/es/constants.js","../node_modules/xstate/es/environment.js","../node_modules/xstate/es/utils.js","../node_modules/xstate/es/mapState.js","../node_modules/xstate/es/types.js","../node_modules/xstate/es/actionTypes.js","../node_modules/xstate/es/actions.js","../node_modules/xstate/es/stateUtils.js","../node_modules/xstate/es/State.js","../node_modules/xstate/es/Actor.js","../node_modules/xstate/es/StateNode.js","../node_modules/xstate/es/Machine.js","../node_modules/xstate/es/scheduler.js","../node_modules/xstate/es/registry.js","../node_modules/xstate/es/devTools.js","../node_modules/xstate/es/interpreter.js","../node_modules/xstate/es/match.js","../node_modules/xstate/es/index.js","12/index.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__values","o","m","Symbol","iterator","next","value","done","__read","r","ar","push","error","__spread","concat","STATE_DELIMITER","EMPTY_ACTIVITY_MAP","DEFAULT_GUARD_TYPE","TARGETLESS_KEY","IS_PRODUCTION","keys","matchesState","parentStateId","childStateId","delimiter","parentStateValue","toStateValue","childStateValue","isString","every","key","getEventType","event","type","Error","toStatePath","stateId","isArray","toString","split","isStateLike","state","stateValue","pathToStateValue","statePath","marker","mapValues","collection","iteratee","result","collectionKeys","mapFilterValues","predicate","e_1","_a","_b","_c","item","e_1_1","return","path","props","object","e_2","props_1","props_1_1","prop","e_2_1","nestedPath","accessorProp","e_3","props_2","props_2_1","e_3_1","toStatePaths","flatten","map","subStateValue","subPath","array","toArrayStrict","toArray","undefined","mapContext","mapper","context","_event","e_5","isFunction","data","subMapper","e_5_1","isBuiltInEvent","eventType","test","isPromiseLike","Promise","then","partition","items","e_6","truthy","falsy","items_1","items_1_1","e_6_1","updateHistoryStates","hist","states","subHist","current","updateHistoryValue","updateContext","assignActions","warn","updatedContext","reduce","acc","assignAction","e_7","assignment","meta","action","partialUpdate","propAssignment","e_7_1","condition","message","console","args","Array","toGuard","guardMap","name","isObservable","subscribe","symbolObservable","observable","isMachine","uniqueId","currentId","toEventObject","payload","toSCXMLEvent","scxmlEvent","$$type","eventObject","toTransitionConfigArray","configLike","transitions","transitionLike","target","normalizeTarget","reportUnhandledExceptionOnInvocation","originalError","currentError","id","originalStackTrace","stack","stackTrace","evaluateGuard","machine","guard","guards","options","guardMeta","cond","condFn","mapState","stateMap","foundStateId","mappedStateId","ActionTypes","SpecialTargets","start","Start","stop","Stop","raise","Raise","send","Send","cancel","Cancel","nullEvent","NullEvent","Assign","after","After","doneState","DoneState","log","Log","init","Init","invoke","Invoke","errorExecution","ErrorExecution","errorPlatform","ErrorPlatform","ErrorCustom","update","Update","choose","Choose","pure","Pure","initEvent","getActionFunction","actionType","actionFunctionMap","toActionObject","actionObject","exec","other","defineProperty","enumerable","configurable","toActionObjects","actions","subAction","toActivityDefinition","to","Internal","raise$1","resolveRaise","send$1","delay","resolveSend","ctx","delaysMap","resolvedEvent","resolvedDelay","configDelay","resolvedTarget","sendParent","Parent","sendUpdate","respond","_","__","origin","defaultLogExpr","expr","label","log$1","resolveLog","sendId","cancel$1","activity","activityDef","assign$1","delayRef","idSuffix","doneInvoke","DoneInvoke","getActions","get","forwardTo","escalate","errorData","error$1","conds","resolveActions","currentState","currentContext","otherActions","resolvedActions","sendAction","delays","choose$1","chooseAction","matchedActions","find","resolved","pure$1","isLeafNode","stateNode","getChildren","getAllStateNodes","stateNodes","getConfiguration","prevStateNodes","e_4","_d","prevConfiguration","Set","prevAdjList","getAdjList","configuration","configuration_1","configuration_1_1","parent","has","add","adjList","configuration_2","configuration_2_1","forEach","sn","initialStateNodes","_e","_f","child","configuration_3","configuration_3_1","e_4_1","getValueFromAdj","baseNode","childStateNodes","childStateNode","csn","Map","configuration_4","configuration_4_1","set","getValue","rootNode","config","iterable","some","member","nextEvents","ownEvents","isInFinalState","stateValuesEqual","a","b","aKeys","bKeys","isState","bindActionToState","boundAction","State","_this","activities","events","_sessionid","historyValue","history","matches","bind","toStrings","children","from","create","inert","valueKeys","toJSON","jsonValues","createNullActor","unsubscribe","createInvocableActor","invokeDefinition","tempActor","isActor","NULL_EVENT","STATE_IDENTIFIER","WILDCARD","EMPTY_OBJECT","isStateId","str","createDefaultOptions","services","validateArrayifiedTransitions","hasNonLastUnguardedTarget","slice","transition","eventText","StateNode","order","__xstatenode","__cache","relativeValue","initialStateValue","initialState","on","candidates","delayedTransitions","idMap","_parent","_key","join","version","parallel","initial","stateConfig","dfs","_transient","strict","onEntry","entry","onExit","exit","invokeConfig","src","invokeSrc","_init","withConfig","withContext","definition","getDelayedTransitions","formatTransitions","getCandidates","eventName","transient","filter","sameEventType","afterConfig","mutateEntryExit","configTransition","resolvedTransition","isNaN","delayedTransition","formatTransition","getStateNodes","getStateNode","subStateKeys","subStateNodes","subStateKey","allSubStateNodes","subStateNode","handles","includes","resolveState","resolve","transitionLeafNode","transitionCompoundNode","_transition","transitionParallelNode","transitionMap","stateTransitions","enabledTransitions","st","willTransition","entryNodes","entrySet","exitSet","source","nextStateNodes","selectedTransition","candidate","stateIn","in","resolvedContext","isInState","getStateNodeById","guardPassed","err","allNextStateNodes","getRelativeStateNodes","isInternal","internal","reentryNodes","nodesFromChild","escapes","nodes","prevState","prevConfig","resolvedConfig","resolvedConfig_1","resolvedConfig_1_1","prevConfig_1","prevConfig_1_1","doneEvents","grandparent","parentNode","sort","entryStates","exitStates","entryActions","exitActions","resolvedStateValue","getResolvedPath","stateTransition","resolveTransition","resolveRaisedTransition","originalEvent","currentActions","unshift","actions_1","actions_1_1","start$1","stop$1","raisedEvents","nonRaisedActions","invokeActions","resolvedConfiguration","isDone","nextState","didUpdateContext","changed","maybeNextState","isTransient","raisedEvent","shift","stateKey","resolvedStateId","getStateNodeByPath","arrayStatePath","currentStateNode","stateIdentifier","getInitialState","historyConfig","relativeStateId","resolveHistory","initialStateNodePaths","initialPath","getFromRelativePath","relativePath","childStatePath","relativeStateValue","historyTarget","relativeChildPath","subHistoryValue","subStatePath","childStateIds","stateIds","e_8","event_1","e_8_1","resolveTarget","_target","isInternalTarget","targetStateNode","transitionConfig","normalizedTarget","e_9","onConfig","wildcardConfigs","strictOnConfigs_1","arrayified","doneConfig","onDone","String","invokeDef","settleTransitions","onError","formattedTransitions","delayedTransitions_1","delayedTransitions_1_1","e_9_1","Machine","initialContext","resolvedInitialContext","createMachine","defaultOptions","deferEvents","Scheduler","processingEvent","queue","initialized","initialize","callback","schedule","process","flushEvents","task","clear","nextCallback","sessionIdIndex","registry","bookId","register","actor","free","delete","getDevTools","w","window","__xstate__","registerService","service","devTools","DEFAULT_SPAWN_OPTIONS","sync","autoForward","withServiceScope","serviceStack","fn","pop","InterpreterStatus","Interpreter","scheduler","delayedEventsMap","listeners","contextListeners","stopListeners","doneListeners","eventListeners","sendListeners","_status","NotStarted","batch","Stopped","JSON","stringify","Running","forward","_state","sendTo","isParent","sessionId","resolvedOptions","clock","logger","resolvedId","_initialState","execute","actionsConfig","listener","_g","_h","_j","_k","contextListener","finalChildStateNode","doneData","_l","_m","onTransition","nextListenerOrObserver","errorListener","completeListener","resolvedCompleteListener","complete","onEvent","onSend","onChange","onStop","off","resolvedState","attachDev","e_10","_o","_p","_q","clearTimeout","e_10_1","e_11","batchChanged","batchedActions","_loop_1","events_1","events_1_1","e_11_1","sender","nextEvent","e_12","e_12_1","defer","setTimeout","actionOrExec","serviceCreator","spawnPromise","spawnCallback","spawnObservable","spawnMachine","spawnActivity","stopChild","removeChild","childId","spawn","entity","spawnActor","childService","doneEvent","promise","canceled","response","errorEvent","handleError","unsubscribed","receivers","receive","callbackStop","newListener","receiver","subscription","implementation","dispose","spawnEffect","__REDUX_DEVTOOLS_EXTENSION__","devToolsOptions","connect","autoPause","stateSanitizer","features","jump","skip","global","ms","interpret","resolveSpawnOptions","nameOrOptions","interpreter","matchState","patterns","defaultValue","patterns_1","patterns_1_1","elBox","document","querySelector","randomFetch","res","rej","Math","random","idle","FETCH","pending","RESOLVE","rejected","dataset","addEventListener","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","parse","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","generated","js","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","overlay","createErrorOverlay","body","appendChild","getElementById","remove","createElement","innerText","innerHTML","getParents","modules","parents","k","d","dep","Function","deps","cached","cache","cb"],"mappings":"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","file":"12.e032bb13.js","sourceRoot":"..\\src","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n\n  return ar;\n}\n\nexport { __assign, __read, __rest, __spread, __values };","var STATE_DELIMITER = '.';\nvar EMPTY_ACTIVITY_MAP = {};\nvar DEFAULT_GUARD_TYPE = 'xstate.guard';\nvar TARGETLESS_KEY = '';\nexport { DEFAULT_GUARD_TYPE, EMPTY_ACTIVITY_MAP, STATE_DELIMITER, TARGETLESS_KEY };","var IS_PRODUCTION = process.env.NODE_ENV === 'production';\nexport { IS_PRODUCTION };","import { __spread, __values, __read, __assign } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, TARGETLESS_KEY, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\n\nfunction keys(value) {\n  return Object.keys(value);\n}\n\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\n\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\n\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\n\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\n\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\n\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\n\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\n\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = __values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\n\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\n\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, __spread(array));\n}\n\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\n\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\n\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\n\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\n\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = __read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\n\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\n\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\n\nfunction updateContext(context, _event, assignActions, state) {\n  if (!IS_PRODUCTION) {\n    warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = __values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\n\nvar warn = function () {};\n\nif (!IS_PRODUCTION) {\n  warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\n\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\n\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\n\nvar symbolObservable = /*#__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar uniqueId = /*#__PURE__*/function () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\n\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return __assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\n\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return __assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\n\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      // @ts-ignore until Type instantiation is excessively deep and possibly infinite bug is fixed\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return __assign(__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\n\nfunction normalizeTarget(target) {\n  if (target === undefined || target === TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\n\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\n\nfunction evaluateGuard(machine, guard, context, _event, state) {\n  var guards = machine.options.guards;\n  var guardMeta = {\n    state: state,\n    cond: guard,\n    _event: _event\n  }; // TODO: do not hardcode!\n\n  if (guard.type === DEFAULT_GUARD_TYPE) {\n    return guard.predicate(context, _event.data, guardMeta);\n  }\n\n  var condFn = guards[guard.type];\n\n  if (!condFn) {\n    throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + machine.id + \"'.\");\n  }\n\n  return condFn(context, _event.data, guardMeta);\n}\n\nexport { evaluateGuard, flatten, getEventType, isArray, isBuiltInEvent, isFunction, isMachine, isObservable, isPromiseLike, isStateLike, isString, keys, mapContext, mapFilterValues, mapValues, matchesState, nestedPath, normalizeTarget, partition, path, pathToStateValue, reportUnhandledExceptionOnInvocation, symbolObservable, toArray, toArrayStrict, toEventObject, toGuard, toSCXMLEvent, toStatePath, toStatePaths, toStateValue, toTransitionConfigArray, uniqueId, updateContext, updateHistoryStates, updateHistoryValue, warn };","import { __values } from './_virtual/_tslib.js';\nimport { keys, matchesState } from './utils.js';\n\nfunction mapState(stateMap, stateId) {\n  var e_1, _a;\n\n  var foundStateId;\n\n  try {\n    for (var _b = __values(keys(stateMap)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var mappedStateId = _c.value;\n\n      if (matchesState(mappedStateId, stateId) && (!foundStateId || stateId.length > foundStateId.length)) {\n        foundStateId = mappedStateId;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return stateMap[foundStateId];\n}\n\nexport { mapState };","var ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[\"Start\"] = \"xstate.start\";\n  ActionTypes[\"Stop\"] = \"xstate.stop\";\n  ActionTypes[\"Raise\"] = \"xstate.raise\";\n  ActionTypes[\"Send\"] = \"xstate.send\";\n  ActionTypes[\"Cancel\"] = \"xstate.cancel\";\n  ActionTypes[\"NullEvent\"] = \"\";\n  ActionTypes[\"Assign\"] = \"xstate.assign\";\n  ActionTypes[\"After\"] = \"xstate.after\";\n  ActionTypes[\"DoneState\"] = \"done.state\";\n  ActionTypes[\"DoneInvoke\"] = \"done.invoke\";\n  ActionTypes[\"Log\"] = \"xstate.log\";\n  ActionTypes[\"Init\"] = \"xstate.init\";\n  ActionTypes[\"Invoke\"] = \"xstate.invoke\";\n  ActionTypes[\"ErrorExecution\"] = \"error.execution\";\n  ActionTypes[\"ErrorCommunication\"] = \"error.communication\";\n  ActionTypes[\"ErrorPlatform\"] = \"error.platform\";\n  ActionTypes[\"ErrorCustom\"] = \"xstate.error\";\n  ActionTypes[\"Update\"] = \"xstate.update\";\n  ActionTypes[\"Pure\"] = \"xstate.pure\";\n  ActionTypes[\"Choose\"] = \"xstate.choose\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar SpecialTargets;\n\n(function (SpecialTargets) {\n  SpecialTargets[\"Parent\"] = \"#_parent\";\n  SpecialTargets[\"Internal\"] = \"#_internal\";\n})(SpecialTargets || (SpecialTargets = {}));\n\nexport { ActionTypes, SpecialTargets };","import { ActionTypes } from './types.js'; // xstate-specific action types\n\nvar start = ActionTypes.Start;\nvar stop = ActionTypes.Stop;\nvar raise = ActionTypes.Raise;\nvar send = ActionTypes.Send;\nvar cancel = ActionTypes.Cancel;\nvar nullEvent = ActionTypes.NullEvent;\nvar assign = ActionTypes.Assign;\nvar after = ActionTypes.After;\nvar doneState = ActionTypes.DoneState;\nvar log = ActionTypes.Log;\nvar init = ActionTypes.Init;\nvar invoke = ActionTypes.Invoke;\nvar errorExecution = ActionTypes.ErrorExecution;\nvar errorPlatform = ActionTypes.ErrorPlatform;\nvar error = ActionTypes.ErrorCustom;\nvar update = ActionTypes.Update;\nvar choose = ActionTypes.Choose;\nvar pure = ActionTypes.Pure;\nexport { after, assign, cancel, choose, doneState, error, errorExecution, errorPlatform, init, invoke, log, nullEvent, pure, raise, send, start, stop, update };","import { __assign, __read, __rest } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { toSCXMLEvent, isFunction, toEventObject, getEventType, isString, partition, updateContext, flatten, toArray, toGuard, evaluateGuard, warn, isArray } from './utils.js';\nimport { SpecialTargets, ActionTypes } from './types.js';\nimport { send as send$1, update, assign as assign$1, init, raise as raise$1, log as log$1, cancel as cancel$1, error as error$1, pure as pure$1, choose as choose$1 } from './actionTypes.js';\nvar initEvent = /*#__PURE__*/toSCXMLEvent({\n  type: init\n});\n\nfunction getActionFunction(actionType, actionFunctionMap) {\n  return actionFunctionMap ? actionFunctionMap[actionType] || undefined : undefined;\n}\n\nfunction toActionObject(action, actionFunctionMap) {\n  var actionObject;\n\n  if (isString(action) || typeof action === 'number') {\n    var exec = getActionFunction(action, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = {\n        type: action,\n        exec: exec\n      };\n    } else if (exec) {\n      actionObject = exec;\n    } else {\n      actionObject = {\n        type: action,\n        exec: undefined\n      };\n    }\n  } else if (isFunction(action)) {\n    actionObject = {\n      // Convert action to string if unnamed\n      type: action.name || action.toString(),\n      exec: action\n    };\n  } else {\n    var exec = getActionFunction(action.type, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = __assign(__assign({}, action), {\n        exec: exec\n      });\n    } else if (exec) {\n      var type = action.type,\n          other = __rest(action, [\"type\"]);\n\n      actionObject = __assign(__assign({\n        type: type\n      }, exec), other);\n    } else {\n      actionObject = action;\n    }\n  }\n\n  Object.defineProperty(actionObject, 'toString', {\n    value: function () {\n      return actionObject.type;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  return actionObject;\n}\n\nvar toActionObjects = function (action, actionFunctionMap) {\n  if (!action) {\n    return [];\n  }\n\n  var actions = isArray(action) ? action : [action];\n  return actions.map(function (subAction) {\n    return toActionObject(subAction, actionFunctionMap);\n  });\n};\n\nfunction toActivityDefinition(action) {\n  var actionObject = toActionObject(action);\n  return __assign(__assign({\n    id: isString(action) ? action : actionObject.id\n  }, actionObject), {\n    type: actionObject.type\n  });\n}\n/**\r\n * Raises an event. This places the event in the internal event queue, so that\r\n * the event is immediately consumed by the machine in the current step.\r\n *\r\n * @param eventType The event to raise.\r\n */\n\n\nfunction raise(event) {\n  if (!isString(event)) {\n    return send(event, {\n      to: SpecialTargets.Internal\n    });\n  }\n\n  return {\n    type: raise$1,\n    event: event\n  };\n}\n\nfunction resolveRaise(action) {\n  return {\n    type: raise$1,\n    _event: toSCXMLEvent(action.event)\n  };\n}\n/**\r\n * Sends an event. This returns an action that will be read by an interpreter to\r\n * send the event in the next step, after the current step is finished executing.\r\n *\r\n * @param event The event to send.\r\n * @param options Options to pass into the send event:\r\n *  - `id` - The unique send event identifier (used with `cancel()`).\r\n *  - `delay` - The number of milliseconds to delay the sending of the event.\r\n *  - `to` - The target of this event (by default, the machine the event was sent from).\r\n */\n\n\nfunction send(event, options) {\n  return {\n    to: options ? options.to : undefined,\n    type: send$1,\n    event: isFunction(event) ? event : toEventObject(event),\n    delay: options ? options.delay : undefined,\n    id: options && options.id !== undefined ? options.id : isFunction(event) ? event.name : getEventType(event)\n  };\n}\n\nfunction resolveSend(action, ctx, _event, delaysMap) {\n  var meta = {\n    _event: _event\n  }; // TODO: helper function for resolving Expr\n\n  var resolvedEvent = toSCXMLEvent(isFunction(action.event) ? action.event(ctx, _event.data, meta) : action.event);\n  var resolvedDelay;\n\n  if (isString(action.delay)) {\n    var configDelay = delaysMap && delaysMap[action.delay];\n    resolvedDelay = isFunction(configDelay) ? configDelay(ctx, _event.data, meta) : configDelay;\n  } else {\n    resolvedDelay = isFunction(action.delay) ? action.delay(ctx, _event.data, meta) : action.delay;\n  }\n\n  var resolvedTarget = isFunction(action.to) ? action.to(ctx, _event.data, meta) : action.to;\n  return __assign(__assign({}, action), {\n    to: resolvedTarget,\n    _event: resolvedEvent,\n    event: resolvedEvent.data,\n    delay: resolvedDelay\n  });\n}\n/**\r\n * Sends an event to this machine's parent.\r\n *\r\n * @param event The event to send to the parent machine.\r\n * @param options Options to pass into the send event.\r\n */\n\n\nfunction sendParent(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n/**\r\n * Sends an update event to this machine's parent.\r\n */\n\n\nfunction sendUpdate() {\n  return sendParent(update);\n}\n/**\r\n * Sends an event back to the sender of the original event.\r\n *\r\n * @param event The event to send back to the sender\r\n * @param options Options to pass into the send event\r\n */\n\n\nfunction respond(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: function (_, __, _a) {\n      var _event = _a._event;\n      return _event.origin; // TODO: handle when _event.origin is undefined\n    }\n  }));\n}\n\nvar defaultLogExpr = function (context, event) {\n  return {\n    context: context,\n    event: event\n  };\n};\n/**\r\n *\r\n * @param expr The expression function to evaluate which will be logged.\r\n *  Takes in 2 arguments:\r\n *  - `ctx` - the current state context\r\n *  - `event` - the event that caused this action to be executed.\r\n * @param label The label to give to the logged expression.\r\n */\n\n\nfunction log(expr, label) {\n  if (expr === void 0) {\n    expr = defaultLogExpr;\n  }\n\n  return {\n    type: log$1,\n    label: label,\n    expr: expr\n  };\n}\n\nvar resolveLog = function (action, ctx, _event) {\n  return __assign(__assign({}, action), {\n    value: isString(action.expr) ? action.expr : action.expr(ctx, _event.data, {\n      _event: _event\n    })\n  });\n};\n/**\r\n * Cancels an in-flight `send(...)` action. A canceled sent action will not\r\n * be executed, nor will its event be sent, unless it has already been sent\r\n * (e.g., if `cancel(...)` is called after the `send(...)` action's `delay`).\r\n *\r\n * @param sendId The `id` of the `send(...)` action to cancel.\r\n */\n\n\nvar cancel = function (sendId) {\n  return {\n    type: cancel$1,\n    sendId: sendId\n  };\n};\n/**\r\n * Starts an activity.\r\n *\r\n * @param activity The activity to start.\r\n */\n\n\nfunction start(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Start,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Stops an activity.\r\n *\r\n * @param activity The activity to stop.\r\n */\n\n\nfunction stop(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Stop,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Updates the current context of the machine.\r\n *\r\n * @param assignment An object that represents the partial context to update.\r\n */\n\n\nvar assign = function (assignment) {\n  return {\n    type: assign$1,\n    assignment: assignment\n  };\n};\n/**\r\n * Returns an event type that represents an implicit event that\r\n * is sent after the specified `delay`.\r\n *\r\n * @param delayRef The delay in milliseconds\r\n * @param id The state node ID where this event is handled\r\n */\n\n\nfunction after(delayRef, id) {\n  var idSuffix = id ? \"#\" + id : '';\n  return ActionTypes.After + \"(\" + delayRef + \")\" + idSuffix;\n}\n/**\r\n * Returns an event that represents that a final state node\r\n * has been reached in the parent state node.\r\n *\r\n * @param id The final state node's parent state node `id`\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction done(id, data) {\n  var type = ActionTypes.DoneState + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Returns an event that represents that an invoked service has terminated.\r\n *\r\n * An invoked service is terminated when it has reached a top-level final state node,\r\n * but not when it is canceled.\r\n *\r\n * @param id The final state node ID\r\n * @param data The data to pass into the event\r\n */\n\n\nfunction doneInvoke(id, data) {\n  var type = ActionTypes.DoneInvoke + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction error(id, data) {\n  var type = ActionTypes.ErrorPlatform + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n\nfunction pure(getActions) {\n  return {\n    type: ActionTypes.Pure,\n    get: getActions\n  };\n}\n/**\r\n * Forwards (sends) an event to a specified service.\r\n *\r\n * @param target The target service to forward the event to.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction forwardTo(target, options) {\n  return send(function (_, event) {\n    return event;\n  }, __assign(__assign({}, options), {\n    to: target\n  }));\n}\n/**\r\n * Escalates an error by sending it as an event to this machine's parent.\r\n *\r\n * @param errorData The error data to send, or the expression function that\r\n * takes in the `context`, `event`, and `meta`, and returns the error data to send.\r\n * @param options Options to pass into the send action creator.\r\n */\n\n\nfunction escalate(errorData, options) {\n  return sendParent(function (context, event, meta) {\n    return {\n      type: error$1,\n      data: isFunction(errorData) ? errorData(context, event, meta) : errorData\n    };\n  }, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n\nfunction choose(conds) {\n  return {\n    type: ActionTypes.Choose,\n    conds: conds\n  };\n}\n\nfunction resolveActions(machine, currentState, currentContext, _event, actions) {\n  var _a = __read(partition(actions, function (action) {\n    return action.type === assign$1;\n  }), 2),\n      assignActions = _a[0],\n      otherActions = _a[1];\n\n  var updatedContext = assignActions.length ? updateContext(currentContext, _event, assignActions, currentState) : currentContext;\n  var resolvedActions = flatten(otherActions.map(function (actionObject) {\n    var _a;\n\n    switch (actionObject.type) {\n      case raise$1:\n        return resolveRaise(actionObject);\n\n      case send$1:\n        var sendAction = resolveSend(actionObject, updatedContext, _event, machine.options.delays); // TODO: fix ActionTypes.Init\n\n        if (!IS_PRODUCTION) {\n          // warn after resolving as we can create better contextual message here\n          warn(!isString(actionObject.delay) || typeof sendAction.delay === 'number', // tslint:disable-next-line:max-line-length\n          \"No delay reference for delay expression '\" + actionObject.delay + \"' was found on machine '\" + machine.id + \"'\");\n        }\n\n        return sendAction;\n\n      case log$1:\n        return resolveLog(actionObject, updatedContext, _event);\n\n      case choose$1:\n        {\n          var chooseAction = actionObject;\n          var matchedActions = (_a = chooseAction.conds.find(function (condition) {\n            var guard = toGuard(condition.cond, machine.options.guards);\n            return !guard || evaluateGuard(machine, guard, updatedContext, _event, currentState);\n          })) === null || _a === void 0 ? void 0 : _a.actions;\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var resolved = resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions)));\n          updatedContext = resolved[1];\n          return resolved[0];\n        }\n\n      case pure$1:\n        {\n          var matchedActions = actionObject.get(updatedContext, _event.data);\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var resolved = resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions)));\n          updatedContext = resolved[1];\n          return resolved[0];\n        }\n\n      default:\n        return toActionObject(actionObject, machine.options.actions);\n    }\n  }));\n  return [resolvedActions, updatedContext];\n}\n\nexport { after, assign, cancel, choose, done, doneInvoke, error, escalate, forwardTo, getActionFunction, initEvent, log, pure, raise, resolveActions, resolveLog, resolveRaise, resolveSend, respond, send, sendParent, sendUpdate, start, stop, toActionObject, toActionObjects, toActivityDefinition };","import { __values, __spread } from './_virtual/_tslib.js';\nimport { keys, flatten } from './utils.js';\n\nvar isLeafNode = function (stateNode) {\n  return stateNode.type === 'atomic' || stateNode.type === 'final';\n};\n\nfunction getChildren(stateNode) {\n  return keys(stateNode.states).map(function (key) {\n    return stateNode.states[key];\n  });\n}\n\nfunction getAllStateNodes(stateNode) {\n  var stateNodes = [stateNode];\n\n  if (isLeafNode(stateNode)) {\n    return stateNodes;\n  }\n\n  return stateNodes.concat(flatten(getChildren(stateNode).map(getAllStateNodes)));\n}\n\nfunction getConfiguration(prevStateNodes, stateNodes) {\n  var e_1, _a, e_2, _b, e_3, _c, e_4, _d;\n\n  var prevConfiguration = new Set(prevStateNodes);\n  var prevAdjList = getAdjList(prevConfiguration);\n  var configuration = new Set(stateNodes);\n\n  try {\n    // add all ancestors\n    for (var configuration_1 = __values(configuration), configuration_1_1 = configuration_1.next(); !configuration_1_1.done; configuration_1_1 = configuration_1.next()) {\n      var s = configuration_1_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (configuration_1_1 && !configuration_1_1.done && (_a = configuration_1.return)) _a.call(configuration_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  var adjList = getAdjList(configuration);\n\n  try {\n    // add descendants\n    for (var configuration_2 = __values(configuration), configuration_2_1 = configuration_2.next(); !configuration_2_1.done; configuration_2_1 = configuration_2.next()) {\n      var s = configuration_2_1.value; // if previously active, add existing child nodes\n\n      if (s.type === 'compound' && (!adjList.get(s) || !adjList.get(s).length)) {\n        if (prevAdjList.get(s)) {\n          prevAdjList.get(s).forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        } else {\n          s.initialStateNodes.forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        }\n      } else {\n        if (s.type === 'parallel') {\n          try {\n            for (var _e = (e_3 = void 0, __values(getChildren(s))), _f = _e.next(); !_f.done; _f = _e.next()) {\n              var child = _f.value;\n\n              if (child.type === 'history') {\n                continue;\n              }\n\n              if (!configuration.has(child)) {\n                configuration.add(child);\n\n                if (prevAdjList.get(child)) {\n                  prevAdjList.get(child).forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                } else {\n                  child.initialStateNodes.forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                }\n              }\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_f && !_f.done && (_c = _e.return)) _c.call(_e);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n        }\n      }\n    }\n  } catch (e_2_1) {\n    e_2 = {\n      error: e_2_1\n    };\n  } finally {\n    try {\n      if (configuration_2_1 && !configuration_2_1.done && (_b = configuration_2.return)) _b.call(configuration_2);\n    } finally {\n      if (e_2) throw e_2.error;\n    }\n  }\n\n  try {\n    // add all ancestors\n    for (var configuration_3 = __values(configuration), configuration_3_1 = configuration_3.next(); !configuration_3_1.done; configuration_3_1 = configuration_3.next()) {\n      var s = configuration_3_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_4_1) {\n    e_4 = {\n      error: e_4_1\n    };\n  } finally {\n    try {\n      if (configuration_3_1 && !configuration_3_1.done && (_d = configuration_3.return)) _d.call(configuration_3);\n    } finally {\n      if (e_4) throw e_4.error;\n    }\n  }\n\n  return configuration;\n}\n\nfunction getValueFromAdj(baseNode, adjList) {\n  var childStateNodes = adjList.get(baseNode);\n\n  if (!childStateNodes) {\n    return {}; // todo: fix?\n  }\n\n  if (baseNode.type === 'compound') {\n    var childStateNode = childStateNodes[0];\n\n    if (childStateNode) {\n      if (isLeafNode(childStateNode)) {\n        return childStateNode.key;\n      }\n    } else {\n      return {};\n    }\n  }\n\n  var stateValue = {};\n  childStateNodes.forEach(function (csn) {\n    stateValue[csn.key] = getValueFromAdj(csn, adjList);\n  });\n  return stateValue;\n}\n\nfunction getAdjList(configuration) {\n  var e_5, _a;\n\n  var adjList = new Map();\n\n  try {\n    for (var configuration_4 = __values(configuration), configuration_4_1 = configuration_4.next(); !configuration_4_1.done; configuration_4_1 = configuration_4.next()) {\n      var s = configuration_4_1.value;\n\n      if (!adjList.has(s)) {\n        adjList.set(s, []);\n      }\n\n      if (s.parent) {\n        if (!adjList.has(s.parent)) {\n          adjList.set(s.parent, []);\n        }\n\n        adjList.get(s.parent).push(s);\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (configuration_4_1 && !configuration_4_1.done && (_a = configuration_4.return)) _a.call(configuration_4);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return adjList;\n}\n\nfunction getValue(rootNode, configuration) {\n  var config = getConfiguration([rootNode], configuration);\n  return getValueFromAdj(rootNode, getAdjList(config));\n}\n\nfunction has(iterable, item) {\n  if (Array.isArray(iterable)) {\n    return iterable.some(function (member) {\n      return member === item;\n    });\n  }\n\n  if (iterable instanceof Set) {\n    return iterable.has(item);\n  }\n\n  return false; // TODO: fix\n}\n\nfunction nextEvents(configuration) {\n  return flatten(__spread(new Set(configuration.map(function (sn) {\n    return sn.ownEvents;\n  }))));\n}\n\nfunction isInFinalState(configuration, stateNode) {\n  if (stateNode.type === 'compound') {\n    return getChildren(stateNode).some(function (s) {\n      return s.type === 'final' && has(configuration, s);\n    });\n  }\n\n  if (stateNode.type === 'parallel') {\n    return getChildren(stateNode).every(function (sn) {\n      return isInFinalState(configuration, sn);\n    });\n  }\n\n  return false;\n}\n\nexport { getAdjList, getAllStateNodes, getChildren, getConfiguration, getValue, has, isInFinalState, isLeafNode, nextEvents };","import { __spread, __rest, __assign } from './_virtual/_tslib.js';\nimport { EMPTY_ACTIVITY_MAP } from './constants.js';\nimport { isString, matchesState, keys } from './utils.js';\nimport { nextEvents } from './stateUtils.js';\nimport { initEvent } from './actions.js';\n\nfunction stateValuesEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a === undefined || b === undefined) {\n    return false;\n  }\n\n  if (isString(a) || isString(b)) {\n    return a === b;\n  }\n\n  var aKeys = keys(a);\n  var bKeys = keys(b);\n  return aKeys.length === bKeys.length && aKeys.every(function (key) {\n    return stateValuesEqual(a[key], b[key]);\n  });\n}\n\nfunction isState(state) {\n  if (isString(state)) {\n    return false;\n  }\n\n  return 'value' in state && 'history' in state;\n}\n\nfunction bindActionToState(action, state) {\n  var exec = action.exec;\n\n  var boundAction = __assign(__assign({}, action), {\n    exec: exec !== undefined ? function () {\n      return exec(state.context, state.event, {\n        action: action,\n        state: state,\n        _event: state._event\n      });\n    } : undefined\n  });\n\n  return boundAction;\n}\n\nvar State =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new State instance.\r\n   * @param value The state value\r\n   * @param context The extended state\r\n   * @param historyValue The tree representing historical values of the state nodes\r\n   * @param history The previous state\r\n   * @param actions An array of action objects to execute as side-effects\r\n   * @param activities A mapping of activities and whether they are started (`true`) or stopped (`false`).\r\n   * @param meta\r\n   * @param events Internal event queue. Should be empty with run-to-completion semantics.\r\n   * @param configuration\r\n   */\n  function State(config) {\n    var _this = this;\n\n    this.actions = [];\n    this.activities = EMPTY_ACTIVITY_MAP;\n    this.meta = {};\n    this.events = [];\n    this.value = config.value;\n    this.context = config.context;\n    this._event = config._event;\n    this._sessionid = config._sessionid;\n    this.event = this._event.data;\n    this.historyValue = config.historyValue;\n    this.history = config.history;\n    this.actions = config.actions || [];\n    this.activities = config.activities || EMPTY_ACTIVITY_MAP;\n    this.meta = config.meta || {};\n    this.events = config.events || [];\n    this.matches = this.matches.bind(this);\n    this.toStrings = this.toStrings.bind(this);\n    this.configuration = config.configuration;\n    this.transitions = config.transitions;\n    this.children = config.children;\n    this.done = !!config.done;\n    Object.defineProperty(this, 'nextEvents', {\n      get: function () {\n        return nextEvents(_this.configuration);\n      }\n    });\n  }\n  /**\r\n   * Creates a new State instance for the given `stateValue` and `context`.\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.from = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (stateValue.context !== context) {\n        return new State({\n          value: stateValue.value,\n          context: context,\n          _event: stateValue._event,\n          _sessionid: null,\n          historyValue: stateValue.historyValue,\n          history: stateValue.history,\n          actions: [],\n          activities: stateValue.activities,\n          meta: {},\n          events: [],\n          configuration: [],\n          transitions: [],\n          children: {}\n        });\n      }\n\n      return stateValue;\n    }\n\n    var _event = initEvent;\n    return new State({\n      value: stateValue,\n      context: context,\n      _event: _event,\n      _sessionid: null,\n      historyValue: undefined,\n      history: undefined,\n      actions: [],\n      activities: undefined,\n      meta: undefined,\n      events: [],\n      configuration: [],\n      transitions: [],\n      children: {}\n    });\n  };\n  /**\r\n   * Creates a new State instance for the given `config`.\r\n   * @param config The state config\r\n   */\n\n\n  State.create = function (config) {\n    return new State(config);\n  };\n  /**\r\n   * Creates a new `State` instance for the given `stateValue` and `context` with no actions (side-effects).\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.inert = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (!stateValue.actions.length) {\n        return stateValue;\n      }\n\n      var _event = initEvent;\n      return new State({\n        value: stateValue.value,\n        context: context,\n        _event: _event,\n        _sessionid: null,\n        historyValue: stateValue.historyValue,\n        history: stateValue.history,\n        activities: stateValue.activities,\n        configuration: stateValue.configuration,\n        transitions: [],\n        children: {}\n      });\n    }\n\n    return State.from(stateValue, context);\n  };\n  /**\r\n   * Returns an array of all the string leaf state node paths.\r\n   * @param stateValue\r\n   * @param delimiter The character(s) that separate each subpath in the string state node path.\r\n   */\n\n\n  State.prototype.toStrings = function (stateValue, delimiter) {\n    var _this = this;\n\n    if (stateValue === void 0) {\n      stateValue = this.value;\n    }\n\n    if (delimiter === void 0) {\n      delimiter = '.';\n    }\n\n    if (isString(stateValue)) {\n      return [stateValue];\n    }\n\n    var valueKeys = keys(stateValue);\n    return valueKeys.concat.apply(valueKeys, __spread(valueKeys.map(function (key) {\n      return _this.toStrings(stateValue[key], delimiter).map(function (s) {\n        return key + delimiter + s;\n      });\n    })));\n  };\n\n  State.prototype.toJSON = function () {\n    var _a = this,\n        configuration = _a.configuration,\n        transitions = _a.transitions,\n        jsonValues = __rest(_a, [\"configuration\", \"transitions\"]);\n\n    return jsonValues;\n  };\n  /**\r\n   * Whether the current state value is a subset of the given parent state value.\r\n   * @param parentStateValue\r\n   */\n\n\n  State.prototype.matches = function (parentStateValue) {\n    return matchesState(parentStateValue, this.value);\n  };\n\n  return State;\n}();\n\nexport { State, bindActionToState, isState, stateValuesEqual };","function createNullActor(id) {\n  return {\n    id: id,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    },\n    toJSON: function () {\n      return {\n        id: id\n      };\n    }\n  };\n}\n/**\r\n * Creates a null actor that is able to be invoked given the provided\r\n * invocation information in its `.meta` value.\r\n *\r\n * @param invokeDefinition The meta information needed to invoke the actor.\r\n */\n\n\nfunction createInvocableActor(invokeDefinition) {\n  var tempActor = createNullActor(invokeDefinition.id);\n  tempActor.meta = invokeDefinition;\n  return tempActor;\n}\n\nfunction isActor(item) {\n  try {\n    return typeof item.send === 'function';\n  } catch (e) {\n    return false;\n  }\n}\n\nexport { createInvocableActor, createNullActor, isActor };","import { __assign, __values, __spread, __read, __rest } from './_virtual/_tslib.js';\nimport { STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { mapValues, isArray, flatten, keys, toArray, toStateValue, isString, getEventType, matchesState, path, evaluateGuard, mapContext, toSCXMLEvent, pathToStateValue, isBuiltInEvent, partition, updateHistoryValue, toStatePath, mapFilterValues, warn, toStatePaths, nestedPath, normalizeTarget, toGuard, toTransitionConfigArray, isMachine, isFunction } from './utils.js';\nimport { SpecialTargets } from './types.js';\nimport { getAllStateNodes, getConfiguration, has, getChildren, isInFinalState, getValue, isLeafNode } from './stateUtils.js';\nimport { start as start$1, stop as stop$1, invoke, update, nullEvent, raise as raise$1, send as send$1 } from './actionTypes.js';\nimport { done, start, raise, stop, toActionObjects, resolveActions, doneInvoke, error, toActionObject, toActivityDefinition, after, send, cancel, initEvent } from './actions.js';\nimport { State, stateValuesEqual } from './State.js';\nimport { createInvocableActor } from './Actor.js';\nvar NULL_EVENT = '';\nvar STATE_IDENTIFIER = '#';\nvar WILDCARD = '*';\nvar EMPTY_OBJECT = {};\n\nvar isStateId = function (str) {\n  return str[0] === STATE_IDENTIFIER;\n};\n\nvar createDefaultOptions = function () {\n  return {\n    actions: {},\n    guards: {},\n    services: {},\n    activities: {},\n    delays: {}\n  };\n};\n\nvar validateArrayifiedTransitions = function (stateNode, event, transitions) {\n  var hasNonLastUnguardedTarget = transitions.slice(0, -1).some(function (transition) {\n    return !('cond' in transition) && !('in' in transition) && (isString(transition.target) || isMachine(transition.target));\n  });\n  var eventText = event === NULL_EVENT ? 'the transient event' : \"event '\" + event + \"'\";\n  warn(!hasNonLastUnguardedTarget, \"One or more transitions for \" + eventText + \" on state '\" + stateNode.id + \"' are unreachable. \" + \"Make sure that the default transition is the last one defined.\");\n};\n\nvar StateNode =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function StateNode(\n  /**\r\n   * The raw config used to create the machine.\r\n   */\n  config, options,\n  /**\r\n   * The initial extended state\r\n   */\n  context) {\n    var _this = this;\n\n    this.config = config;\n    this.context = context;\n    /**\r\n     * The order this state node appears. Corresponds to the implicit SCXML document order.\r\n     */\n\n    this.order = -1;\n    this.__xstatenode = true;\n    this.__cache = {\n      events: undefined,\n      relativeValue: new Map(),\n      initialStateValue: undefined,\n      initialState: undefined,\n      on: undefined,\n      transitions: undefined,\n      candidates: {},\n      delayedTransitions: undefined\n    };\n    this.idMap = {};\n    this.options = Object.assign(createDefaultOptions(), options);\n    this.parent = this.options._parent;\n    this.key = this.config.key || this.options._key || this.config.id || '(machine)';\n    this.machine = this.parent ? this.parent.machine : this;\n    this.path = this.parent ? this.parent.path.concat(this.key) : [];\n    this.delimiter = this.config.delimiter || (this.parent ? this.parent.delimiter : STATE_DELIMITER);\n    this.id = this.config.id || __spread([this.machine.key], this.path).join(this.delimiter);\n    this.version = this.parent ? this.parent.version : this.config.version;\n    this.type = this.config.type || (this.config.parallel ? 'parallel' : this.config.states && keys(this.config.states).length ? 'compound' : this.config.history ? 'history' : 'atomic');\n\n    if (!IS_PRODUCTION) {\n      warn(!('parallel' in this.config), \"The \\\"parallel\\\" property is deprecated and will be removed in version 4.1. \" + (this.config.parallel ? \"Replace with `type: 'parallel'`\" : \"Use `type: '\" + this.type + \"'`\") + \" in the config for state node '\" + this.id + \"' instead.\");\n    }\n\n    this.initial = this.config.initial;\n    this.states = this.config.states ? mapValues(this.config.states, function (stateConfig, key) {\n      var _a;\n\n      var stateNode = new StateNode(stateConfig, {\n        _parent: _this,\n        _key: key\n      });\n      Object.assign(_this.idMap, __assign((_a = {}, _a[stateNode.id] = stateNode, _a), stateNode.idMap));\n      return stateNode;\n    }) : EMPTY_OBJECT; // Document order\n\n    var order = 0;\n\n    function dfs(stateNode) {\n      var e_1, _a;\n\n      stateNode.order = order++;\n\n      try {\n        for (var _b = __values(getChildren(stateNode)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n          dfs(child);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n\n    dfs(this); // History config\n\n    this.history = this.config.history === true ? 'shallow' : this.config.history || false;\n    this._transient = !this.config.on ? false : Array.isArray(this.config.on) ? this.config.on.some(function (_a) {\n      var event = _a.event;\n      return event === NULL_EVENT;\n    }) : NULL_EVENT in this.config.on;\n    this.strict = !!this.config.strict; // TODO: deprecate (entry)\n\n    this.onEntry = toArray(this.config.entry || this.config.onEntry).map(function (action) {\n      return toActionObject(action);\n    }); // TODO: deprecate (exit)\n\n    this.onExit = toArray(this.config.exit || this.config.onExit).map(function (action) {\n      return toActionObject(action);\n    });\n    this.meta = this.config.meta;\n    this.data = this.type === 'final' ? this.config.data : undefined;\n    this.invoke = toArray(this.config.invoke).map(function (invokeConfig, i) {\n      var _a, _b;\n\n      if (isMachine(invokeConfig)) {\n        _this.machine.options.services = __assign((_a = {}, _a[invokeConfig.id] = invokeConfig, _a), _this.machine.options.services);\n        return {\n          type: invoke,\n          src: invokeConfig.id,\n          id: invokeConfig.id\n        };\n      } else if (typeof invokeConfig.src !== 'string') {\n        var invokeSrc = _this.id + \":invocation[\" + i + \"]\"; // TODO: util function\n\n        _this.machine.options.services = __assign((_b = {}, _b[invokeSrc] = invokeConfig.src, _b), _this.machine.options.services);\n        return __assign(__assign({\n          type: invoke,\n          id: invokeSrc\n        }, invokeConfig), {\n          src: invokeSrc\n        });\n      } else {\n        return __assign(__assign({}, invokeConfig), {\n          type: invoke,\n          id: invokeConfig.id || invokeConfig.src,\n          src: invokeConfig.src\n        });\n      }\n    });\n    this.activities = toArray(this.config.activities).concat(this.invoke).map(function (activity) {\n      return toActivityDefinition(activity);\n    });\n    this.transition = this.transition.bind(this);\n  }\n\n  StateNode.prototype._init = function () {\n    if (this.__cache.transitions) {\n      return;\n    }\n\n    getAllStateNodes(this).forEach(function (stateNode) {\n      return stateNode.on;\n    });\n  };\n  /**\r\n   * Clones this state machine with custom options and context.\r\n   *\r\n   * @param options Options (actions, guards, activities, services) to recursively merge with the existing options.\r\n   * @param context Custom context (will override predefined context)\r\n   */\n\n\n  StateNode.prototype.withConfig = function (options, context) {\n    if (context === void 0) {\n      context = this.context;\n    }\n\n    var _a = this.options,\n        actions = _a.actions,\n        activities = _a.activities,\n        guards = _a.guards,\n        services = _a.services,\n        delays = _a.delays;\n    return new StateNode(this.config, {\n      actions: __assign(__assign({}, actions), options.actions),\n      activities: __assign(__assign({}, activities), options.activities),\n      guards: __assign(__assign({}, guards), options.guards),\n      services: __assign(__assign({}, services), options.services),\n      delays: __assign(__assign({}, delays), options.delays)\n    }, context);\n  };\n  /**\r\n   * Clones this state machine with custom context.\r\n   *\r\n   * @param context Custom context (will override predefined context, not recursive)\r\n   */\n\n\n  StateNode.prototype.withContext = function (context) {\n    return new StateNode(this.config, this.options, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"definition\", {\n    /**\r\n     * The well-structured state node definition.\r\n     */\n    get: function () {\n      return {\n        id: this.id,\n        key: this.key,\n        version: this.version,\n        context: this.context,\n        type: this.type,\n        initial: this.initial,\n        history: this.history,\n        states: mapValues(this.states, function (state) {\n          return state.definition;\n        }),\n        on: this.on,\n        transitions: this.transitions,\n        entry: this.onEntry,\n        exit: this.onExit,\n        activities: this.activities || [],\n        meta: this.meta,\n        order: this.order || -1,\n        data: this.data,\n        invoke: this.invoke\n      };\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.toJSON = function () {\n    return this.definition;\n  };\n\n  Object.defineProperty(StateNode.prototype, \"on\", {\n    /**\r\n     * The mapping of events to transitions.\r\n     */\n    get: function () {\n      if (this.__cache.on) {\n        return this.__cache.on;\n      }\n\n      var transitions = this.transitions;\n      return this.__cache.on = transitions.reduce(function (map, transition) {\n        map[transition.eventType] = map[transition.eventType] || [];\n        map[transition.eventType].push(transition);\n        return map;\n      }, {});\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"after\", {\n    get: function () {\n      return this.__cache.delayedTransitions || (this.__cache.delayedTransitions = this.getDelayedTransitions(), this.__cache.delayedTransitions);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"transitions\", {\n    /**\r\n     * All the transitions that can be taken from this state node.\r\n     */\n    get: function () {\n      return this.__cache.transitions || (this.__cache.transitions = this.formatTransitions(), this.__cache.transitions);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.getCandidates = function (eventName) {\n    if (this.__cache.candidates[eventName]) {\n      return this.__cache.candidates[eventName];\n    }\n\n    var transient = eventName === NULL_EVENT;\n    var candidates = this.transitions.filter(function (transition) {\n      var sameEventType = transition.eventType === eventName; // null events should only match against eventless transitions\n\n      return transient ? sameEventType : sameEventType || transition.eventType === WILDCARD;\n    });\n    this.__cache.candidates[eventName] = candidates;\n    return candidates;\n  };\n  /**\r\n   * All delayed transitions from the config.\r\n   */\n\n\n  StateNode.prototype.getDelayedTransitions = function () {\n    var _this = this;\n\n    var afterConfig = this.config.after;\n\n    if (!afterConfig) {\n      return [];\n    }\n\n    var mutateEntryExit = function (delay, i) {\n      var delayRef = isFunction(delay) ? _this.id + \":delay[\" + i + \"]\" : delay;\n      var eventType = after(delayRef, _this.id);\n\n      _this.onEntry.push(send(eventType, {\n        delay: delay\n      }));\n\n      _this.onExit.push(cancel(eventType));\n\n      return eventType;\n    };\n\n    var delayedTransitions = isArray(afterConfig) ? afterConfig.map(function (transition, i) {\n      var eventType = mutateEntryExit(transition.delay, i);\n      return __assign(__assign({}, transition), {\n        event: eventType\n      });\n    }) : flatten(keys(afterConfig).map(function (delay, i) {\n      var configTransition = afterConfig[delay];\n      var resolvedTransition = isString(configTransition) ? {\n        target: configTransition\n      } : configTransition;\n      var resolvedDelay = !isNaN(+delay) ? +delay : delay;\n      var eventType = mutateEntryExit(resolvedDelay, i);\n      return toArray(resolvedTransition).map(function (transition) {\n        return __assign(__assign({}, transition), {\n          event: eventType,\n          delay: resolvedDelay\n        });\n      });\n    }));\n    return delayedTransitions.map(function (delayedTransition) {\n      var delay = delayedTransition.delay;\n      return __assign(__assign({}, _this.formatTransition(delayedTransition)), {\n        delay: delay\n      });\n    });\n  };\n  /**\r\n   * Returns the state nodes represented by the current state value.\r\n   *\r\n   * @param state The state value or State instance\r\n   */\n\n\n  StateNode.prototype.getStateNodes = function (state) {\n    var _a;\n\n    var _this = this;\n\n    if (!state) {\n      return [];\n    }\n\n    var stateValue = state instanceof State ? state.value : toStateValue(state, this.delimiter);\n\n    if (isString(stateValue)) {\n      var initialStateValue = this.getStateNode(stateValue).initial;\n      return initialStateValue !== undefined ? this.getStateNodes((_a = {}, _a[stateValue] = initialStateValue, _a)) : [this.states[stateValue]];\n    }\n\n    var subStateKeys = keys(stateValue);\n    var subStateNodes = subStateKeys.map(function (subStateKey) {\n      return _this.getStateNode(subStateKey);\n    });\n    return subStateNodes.concat(subStateKeys.reduce(function (allSubStateNodes, subStateKey) {\n      var subStateNode = _this.getStateNode(subStateKey).getStateNodes(stateValue[subStateKey]);\n\n      return allSubStateNodes.concat(subStateNode);\n    }, []));\n  };\n  /**\r\n   * Returns `true` if this state node explicitly handles the given event.\r\n   *\r\n   * @param event The event in question\r\n   */\n\n\n  StateNode.prototype.handles = function (event) {\n    var eventType = getEventType(event);\n    return this.events.includes(eventType);\n  };\n  /**\r\n   * Resolves the given `state` to a new `State` instance relative to this machine.\r\n   *\r\n   * This ensures that `.events` and `.nextEvents` represent the correct values.\r\n   *\r\n   * @param state The state to resolve\r\n   */\n\n\n  StateNode.prototype.resolveState = function (state) {\n    var configuration = Array.from(getConfiguration([], this.getStateNodes(state.value)));\n    return new State(__assign(__assign({}, state), {\n      value: this.resolve(state.value),\n      configuration: configuration\n    }));\n  };\n\n  StateNode.prototype.transitionLeafNode = function (stateValue, state, _event) {\n    var stateNode = this.getStateNode(stateValue);\n    var next = stateNode.next(state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionCompoundNode = function (stateValue, state, _event) {\n    var subStateKeys = keys(stateValue);\n    var stateNode = this.getStateNode(subStateKeys[0]);\n\n    var next = stateNode._transition(stateValue[subStateKeys[0]], state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionParallelNode = function (stateValue, state, _event) {\n    var e_2, _a;\n\n    var transitionMap = {};\n\n    try {\n      for (var _b = __values(keys(stateValue)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var subStateKey = _c.value;\n        var subStateValue = stateValue[subStateKey];\n\n        if (!subStateValue) {\n          continue;\n        }\n\n        var subStateNode = this.getStateNode(subStateKey);\n\n        var next = subStateNode._transition(subStateValue, state, _event);\n\n        if (next) {\n          transitionMap[subStateKey] = next;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var stateTransitions = keys(transitionMap).map(function (key) {\n      return transitionMap[key];\n    });\n    var enabledTransitions = flatten(stateTransitions.map(function (st) {\n      return st.transitions;\n    }));\n    var willTransition = stateTransitions.some(function (st) {\n      return st.transitions.length > 0;\n    });\n\n    if (!willTransition) {\n      return this.next(state, _event);\n    }\n\n    var entryNodes = flatten(stateTransitions.map(function (t) {\n      return t.entrySet;\n    }));\n    var configuration = flatten(keys(transitionMap).map(function (key) {\n      return transitionMap[key].configuration;\n    }));\n    return {\n      transitions: enabledTransitions,\n      entrySet: entryNodes,\n      exitSet: flatten(stateTransitions.map(function (t) {\n        return t.exitSet;\n      })),\n      configuration: configuration,\n      source: state,\n      actions: flatten(keys(transitionMap).map(function (key) {\n        return transitionMap[key].actions;\n      }))\n    };\n  };\n\n  StateNode.prototype._transition = function (stateValue, state, _event) {\n    // leaf node\n    if (isString(stateValue)) {\n      return this.transitionLeafNode(stateValue, state, _event);\n    } // hierarchical node\n\n\n    if (keys(stateValue).length === 1) {\n      return this.transitionCompoundNode(stateValue, state, _event);\n    } // orthogonal node\n\n\n    return this.transitionParallelNode(stateValue, state, _event);\n  };\n\n  StateNode.prototype.next = function (state, _event) {\n    var e_3, _a;\n\n    var _this = this;\n\n    var eventName = _event.name;\n    var actions = [];\n    var nextStateNodes = [];\n    var selectedTransition;\n\n    try {\n      for (var _b = __values(this.getCandidates(eventName)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var candidate = _c.value;\n        var cond = candidate.cond,\n            stateIn = candidate.in;\n        var resolvedContext = state.context;\n        var isInState = stateIn ? isString(stateIn) && isStateId(stateIn) ? // Check if in state by ID\n        state.matches(toStateValue(this.getStateNodeById(stateIn).path, this.delimiter)) : // Check if in state by relative grandparent\n        matchesState(toStateValue(stateIn, this.delimiter), path(this.path.slice(0, -2))(state.value)) : true;\n        var guardPassed = false;\n\n        try {\n          guardPassed = !cond || evaluateGuard(this.machine, cond, resolvedContext, _event, state);\n        } catch (err) {\n          throw new Error(\"Unable to evaluate guard '\" + (cond.name || cond.type) + \"' in transition for event '\" + eventName + \"' in state node '\" + this.id + \"':\\n\" + err.message);\n        }\n\n        if (guardPassed && isInState) {\n          if (candidate.target !== undefined) {\n            nextStateNodes = candidate.target;\n          }\n\n          actions.push.apply(actions, __spread(candidate.actions));\n          selectedTransition = candidate;\n          break;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    if (!selectedTransition) {\n      return undefined;\n    }\n\n    if (!nextStateNodes.length) {\n      return {\n        transitions: [selectedTransition],\n        entrySet: [],\n        exitSet: [],\n        configuration: state.value ? [this] : [],\n        source: state,\n        actions: actions\n      };\n    }\n\n    var allNextStateNodes = flatten(nextStateNodes.map(function (stateNode) {\n      return _this.getRelativeStateNodes(stateNode, state.historyValue);\n    }));\n    var isInternal = !!selectedTransition.internal;\n    var reentryNodes = isInternal ? [] : flatten(allNextStateNodes.map(function (n) {\n      return _this.nodesFromChild(n);\n    }));\n    return {\n      transitions: [selectedTransition],\n      entrySet: reentryNodes,\n      exitSet: isInternal ? [] : [this],\n      configuration: allNextStateNodes,\n      source: state,\n      actions: actions\n    };\n  };\n\n  StateNode.prototype.nodesFromChild = function (childStateNode) {\n    if (childStateNode.escapes(this)) {\n      return [];\n    }\n\n    var nodes = [];\n    var marker = childStateNode;\n\n    while (marker && marker !== this) {\n      nodes.push(marker);\n      marker = marker.parent;\n    }\n\n    nodes.push(this); // inclusive\n\n    return nodes;\n  };\n  /**\r\n   * Whether the given state node \"escapes\" this state node. If the `stateNode` is equal to or the parent of\r\n   * this state node, it does not escape.\r\n   */\n\n\n  StateNode.prototype.escapes = function (stateNode) {\n    if (this === stateNode) {\n      return false;\n    }\n\n    var parent = this.parent;\n\n    while (parent) {\n      if (parent === stateNode) {\n        return false;\n      }\n\n      parent = parent.parent;\n    }\n\n    return true;\n  };\n\n  StateNode.prototype.getActions = function (transition, currentContext, _event, prevState) {\n    var e_4, _a, e_5, _b;\n\n    var prevConfig = getConfiguration([], prevState ? this.getStateNodes(prevState.value) : [this]);\n    var resolvedConfig = transition.configuration.length ? getConfiguration(prevConfig, transition.configuration) : prevConfig;\n\n    try {\n      for (var resolvedConfig_1 = __values(resolvedConfig), resolvedConfig_1_1 = resolvedConfig_1.next(); !resolvedConfig_1_1.done; resolvedConfig_1_1 = resolvedConfig_1.next()) {\n        var sn = resolvedConfig_1_1.value;\n\n        if (!has(prevConfig, sn)) {\n          transition.entrySet.push(sn);\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (resolvedConfig_1_1 && !resolvedConfig_1_1.done && (_a = resolvedConfig_1.return)) _a.call(resolvedConfig_1);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    try {\n      for (var prevConfig_1 = __values(prevConfig), prevConfig_1_1 = prevConfig_1.next(); !prevConfig_1_1.done; prevConfig_1_1 = prevConfig_1.next()) {\n        var sn = prevConfig_1_1.value;\n\n        if (!has(resolvedConfig, sn) || has(transition.exitSet, sn.parent)) {\n          transition.exitSet.push(sn);\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (prevConfig_1_1 && !prevConfig_1_1.done && (_b = prevConfig_1.return)) _b.call(prevConfig_1);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    if (!transition.source) {\n      transition.exitSet = []; // Ensure that root StateNode (machine) is entered\n\n      transition.entrySet.push(this);\n    }\n\n    var doneEvents = flatten(transition.entrySet.map(function (sn) {\n      var events = [];\n\n      if (sn.type !== 'final') {\n        return events;\n      }\n\n      var parent = sn.parent;\n\n      if (!parent.parent) {\n        return events;\n      }\n\n      events.push(done(sn.id, sn.data), // TODO: deprecate - final states should not emit done events for their own state.\n      done(parent.id, sn.data ? mapContext(sn.data, currentContext, _event) : undefined));\n      var grandparent = parent.parent;\n\n      if (grandparent.type === 'parallel') {\n        if (getChildren(grandparent).every(function (parentNode) {\n          return isInFinalState(transition.configuration, parentNode);\n        })) {\n          events.push(done(grandparent.id, grandparent.data));\n        }\n      }\n\n      return events;\n    }));\n    transition.exitSet.sort(function (a, b) {\n      return b.order - a.order;\n    });\n    transition.entrySet.sort(function (a, b) {\n      return a.order - b.order;\n    });\n    var entryStates = new Set(transition.entrySet);\n    var exitStates = new Set(transition.exitSet);\n\n    var _c = __read([flatten(Array.from(entryStates).map(function (stateNode) {\n      return __spread(stateNode.activities.map(function (activity) {\n        return start(activity);\n      }), stateNode.onEntry);\n    })).concat(doneEvents.map(raise)), flatten(Array.from(exitStates).map(function (stateNode) {\n      return __spread(stateNode.onExit, stateNode.activities.map(function (activity) {\n        return stop(activity);\n      }));\n    }))], 2),\n        entryActions = _c[0],\n        exitActions = _c[1];\n\n    var actions = toActionObjects(exitActions.concat(transition.actions).concat(entryActions), this.machine.options.actions);\n    return actions;\n  };\n  /**\r\n   * Determines the next state given the current `state` and sent `event`.\r\n   *\r\n   * @param state The current State instance or state value\r\n   * @param event The event that was sent at the current state\r\n   * @param context The current context (extended state) of the current state\r\n   */\n\n\n  StateNode.prototype.transition = function (state, event, context) {\n    if (state === void 0) {\n      state = this.initialState;\n    }\n\n    var _event = toSCXMLEvent(event);\n\n    var currentState;\n\n    if (state instanceof State) {\n      currentState = context === undefined ? state : this.resolveState(State.from(state, context));\n    } else {\n      var resolvedStateValue = isString(state) ? this.resolve(pathToStateValue(this.getResolvedPath(state))) : this.resolve(state);\n      var resolvedContext = context ? context : this.machine.context;\n      currentState = this.resolveState(State.from(resolvedStateValue, resolvedContext));\n    }\n\n    if (!IS_PRODUCTION && _event.name === WILDCARD) {\n      throw new Error(\"An event cannot have the wildcard type ('\" + WILDCARD + \"')\");\n    }\n\n    if (this.strict) {\n      if (!this.events.includes(_event.name) && !isBuiltInEvent(_event.name)) {\n        throw new Error(\"Machine '\" + this.id + \"' does not accept event '\" + _event.name + \"'\");\n      }\n    }\n\n    var stateTransition = this._transition(currentState.value, currentState, _event) || {\n      transitions: [],\n      configuration: [],\n      entrySet: [],\n      exitSet: [],\n      source: currentState,\n      actions: []\n    };\n    var prevConfig = getConfiguration([], this.getStateNodes(currentState.value));\n    var resolvedConfig = stateTransition.configuration.length ? getConfiguration(prevConfig, stateTransition.configuration) : prevConfig;\n    stateTransition.configuration = __spread(resolvedConfig);\n    return this.resolveTransition(stateTransition, currentState, _event);\n  };\n\n  StateNode.prototype.resolveRaisedTransition = function (state, _event, originalEvent) {\n    var _a;\n\n    var currentActions = state.actions;\n    state = this.transition(state, _event); // Save original event to state\n\n    state._event = originalEvent;\n    state.event = originalEvent.data;\n\n    (_a = state.actions).unshift.apply(_a, __spread(currentActions));\n\n    return state;\n  };\n\n  StateNode.prototype.resolveTransition = function (stateTransition, currentState, _event, context) {\n    var e_6, _a;\n\n    if (_event === void 0) {\n      _event = initEvent;\n    }\n\n    if (context === void 0) {\n      context = this.machine.context;\n    }\n\n    var configuration = stateTransition.configuration; // Transition will \"apply\" if:\n    // - this is the initial state (there is no current state)\n    // - OR there are transitions\n\n    var willTransition = !currentState || stateTransition.transitions.length > 0;\n    var resolvedStateValue = willTransition ? getValue(this.machine, configuration) : undefined;\n    var historyValue = currentState ? currentState.historyValue ? currentState.historyValue : stateTransition.source ? this.machine.historyValue(currentState.value) : undefined : undefined;\n    var currentContext = currentState ? currentState.context : context;\n    var actions = this.getActions(stateTransition, currentContext, _event, currentState);\n    var activities = currentState ? __assign({}, currentState.activities) : {};\n\n    try {\n      for (var actions_1 = __values(actions), actions_1_1 = actions_1.next(); !actions_1_1.done; actions_1_1 = actions_1.next()) {\n        var action = actions_1_1.value;\n\n        if (action.type === start$1) {\n          activities[action.activity.type] = action;\n        } else if (action.type === stop$1) {\n          activities[action.activity.type] = false;\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (actions_1_1 && !actions_1_1.done && (_a = actions_1.return)) _a.call(actions_1);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    var _b = __read(resolveActions(this, currentState, currentContext, _event, actions), 2),\n        resolvedActions = _b[0],\n        updatedContext = _b[1];\n\n    var _c = __read(partition(resolvedActions, function (action) {\n      return action.type === raise$1 || action.type === send$1 && action.to === SpecialTargets.Internal;\n    }), 2),\n        raisedEvents = _c[0],\n        nonRaisedActions = _c[1];\n\n    var invokeActions = resolvedActions.filter(function (action) {\n      return action.type === start$1 && action.activity.type === invoke;\n    });\n    var children = invokeActions.reduce(function (acc, action) {\n      acc[action.activity.id] = createInvocableActor(action.activity);\n      return acc;\n    }, currentState ? __assign({}, currentState.children) : {});\n    var resolvedConfiguration = resolvedStateValue ? stateTransition.configuration : currentState ? currentState.configuration : [];\n    var meta = resolvedConfiguration.reduce(function (acc, stateNode) {\n      if (stateNode.meta !== undefined) {\n        acc[stateNode.id] = stateNode.meta;\n      }\n\n      return acc;\n    }, {});\n    var isDone = isInFinalState(resolvedConfiguration, this);\n    var nextState = new State({\n      value: resolvedStateValue || currentState.value,\n      context: updatedContext,\n      _event: _event,\n      // Persist _sessionid between states\n      _sessionid: currentState ? currentState._sessionid : null,\n      historyValue: resolvedStateValue ? historyValue ? updateHistoryValue(historyValue, resolvedStateValue) : undefined : currentState ? currentState.historyValue : undefined,\n      history: !resolvedStateValue || stateTransition.source ? currentState : undefined,\n      actions: resolvedStateValue ? nonRaisedActions : [],\n      activities: resolvedStateValue ? activities : currentState ? currentState.activities : {},\n      meta: resolvedStateValue ? meta : currentState ? currentState.meta : undefined,\n      events: [],\n      configuration: resolvedConfiguration,\n      transitions: stateTransition.transitions,\n      children: children,\n      done: isDone\n    });\n    var didUpdateContext = currentContext !== updatedContext;\n    nextState.changed = _event.name === update || didUpdateContext; // Dispose of penultimate histories to prevent memory leaks\n\n    var history = nextState.history;\n\n    if (history) {\n      delete history.history;\n    }\n\n    if (!resolvedStateValue) {\n      return nextState;\n    }\n\n    var maybeNextState = nextState;\n\n    if (!isDone) {\n      var isTransient = this._transient || configuration.some(function (stateNode) {\n        return stateNode._transient;\n      });\n\n      if (isTransient) {\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, {\n          type: nullEvent\n        }, _event);\n      }\n\n      while (raisedEvents.length) {\n        var raisedEvent = raisedEvents.shift();\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, raisedEvent._event, _event);\n      }\n    } // Detect if state changed\n\n\n    var changed = maybeNextState.changed || (history ? !!maybeNextState.actions.length || didUpdateContext || typeof history.value !== typeof maybeNextState.value || !stateValuesEqual(maybeNextState.value, history.value) : undefined);\n    maybeNextState.changed = changed; // Preserve original history after raised events\n\n    maybeNextState.historyValue = nextState.historyValue;\n    maybeNextState.history = history;\n    return maybeNextState;\n  };\n  /**\r\n   * Returns the child state node from its relative `stateKey`, or throws.\r\n   */\n\n\n  StateNode.prototype.getStateNode = function (stateKey) {\n    if (isStateId(stateKey)) {\n      return this.machine.getStateNodeById(stateKey);\n    }\n\n    if (!this.states) {\n      throw new Error(\"Unable to retrieve child state '\" + stateKey + \"' from '\" + this.id + \"'; no child states exist.\");\n    }\n\n    var result = this.states[stateKey];\n\n    if (!result) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return result;\n  };\n  /**\r\n   * Returns the state node with the given `stateId`, or throws.\r\n   *\r\n   * @param stateId The state ID. The prefix \"#\" is removed.\r\n   */\n\n\n  StateNode.prototype.getStateNodeById = function (stateId) {\n    var resolvedStateId = isStateId(stateId) ? stateId.slice(STATE_IDENTIFIER.length) : stateId;\n\n    if (resolvedStateId === this.id) {\n      return this;\n    }\n\n    var stateNode = this.machine.idMap[resolvedStateId];\n\n    if (!stateNode) {\n      throw new Error(\"Child state node '#\" + resolvedStateId + \"' does not exist on machine '\" + this.id + \"'\");\n    }\n\n    return stateNode;\n  };\n  /**\r\n   * Returns the relative state node from the given `statePath`, or throws.\r\n   *\r\n   * @param statePath The string or string array relative path to the state node.\r\n   */\n\n\n  StateNode.prototype.getStateNodeByPath = function (statePath) {\n    if (typeof statePath === 'string' && isStateId(statePath)) {\n      try {\n        return this.getStateNodeById(statePath.slice(1));\n      } catch (e) {// try individual paths\n        // throw e;\n      }\n    }\n\n    var arrayStatePath = toStatePath(statePath, this.delimiter).slice();\n    var currentStateNode = this;\n\n    while (arrayStatePath.length) {\n      var key = arrayStatePath.shift();\n\n      if (!key.length) {\n        break;\n      }\n\n      currentStateNode = currentStateNode.getStateNode(key);\n    }\n\n    return currentStateNode;\n  };\n  /**\r\n   * Resolves a partial state value with its full representation in this machine.\r\n   *\r\n   * @param stateValue The partial state value to resolve.\r\n   */\n\n\n  StateNode.prototype.resolve = function (stateValue) {\n    var _a;\n\n    var _this = this;\n\n    if (!stateValue) {\n      return this.initialStateValue || EMPTY_OBJECT; // TODO: type-specific properties\n    }\n\n    switch (this.type) {\n      case 'parallel':\n        return mapValues(this.initialStateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(stateValue[subStateKey] || subStateValue) : EMPTY_OBJECT;\n        });\n\n      case 'compound':\n        if (isString(stateValue)) {\n          var subStateNode = this.getStateNode(stateValue);\n\n          if (subStateNode.type === 'parallel' || subStateNode.type === 'compound') {\n            return _a = {}, _a[stateValue] = subStateNode.initialStateValue, _a;\n          }\n\n          return stateValue;\n        }\n\n        if (!keys(stateValue).length) {\n          return this.initialStateValue || {};\n        }\n\n        return mapValues(stateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(subStateValue) : EMPTY_OBJECT;\n        });\n\n      default:\n        return stateValue || EMPTY_OBJECT;\n    }\n  };\n\n  StateNode.prototype.getResolvedPath = function (stateIdentifier) {\n    if (isStateId(stateIdentifier)) {\n      var stateNode = this.machine.idMap[stateIdentifier.slice(STATE_IDENTIFIER.length)];\n\n      if (!stateNode) {\n        throw new Error(\"Unable to find state node '\" + stateIdentifier + \"'\");\n      }\n\n      return stateNode.path;\n    }\n\n    return toStatePath(stateIdentifier, this.delimiter);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateValue\", {\n    get: function () {\n      var _a;\n\n      if (this.__cache.initialStateValue) {\n        return this.__cache.initialStateValue;\n      }\n\n      var initialStateValue;\n\n      if (this.type === 'parallel') {\n        initialStateValue = mapFilterValues(this.states, function (state) {\n          return state.initialStateValue || EMPTY_OBJECT;\n        }, function (stateNode) {\n          return !(stateNode.type === 'history');\n        });\n      } else if (this.initial !== undefined) {\n        if (!this.states[this.initial]) {\n          throw new Error(\"Initial state '\" + this.initial + \"' not found on '\" + this.key + \"'\");\n        }\n\n        initialStateValue = isLeafNode(this.states[this.initial]) ? this.initial : (_a = {}, _a[this.initial] = this.states[this.initial].initialStateValue, _a);\n      }\n\n      this.__cache.initialStateValue = initialStateValue;\n      return this.__cache.initialStateValue;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.getInitialState = function (stateValue, context) {\n    var configuration = this.getStateNodes(stateValue);\n    return this.resolveTransition({\n      configuration: configuration,\n      entrySet: configuration,\n      exitSet: [],\n      transitions: [],\n      source: undefined,\n      actions: []\n    }, undefined, undefined, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialState\", {\n    /**\r\n     * The initial State instance, which includes all actions to be executed from\r\n     * entering the initial state.\r\n     */\n    get: function () {\n      this._init();\n\n      var initialStateValue = this.initialStateValue;\n\n      if (!initialStateValue) {\n        throw new Error(\"Cannot retrieve initial state from simple state '\" + this.id + \"'.\");\n      }\n\n      return this.getInitialState(initialStateValue);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"target\", {\n    /**\r\n     * The target state value of the history state node, if it exists. This represents the\r\n     * default state value to transition to if no history value exists yet.\r\n     */\n    get: function () {\n      var target;\n\n      if (this.type === 'history') {\n        var historyConfig = this.config;\n\n        if (isString(historyConfig.target)) {\n          target = isStateId(historyConfig.target) ? pathToStateValue(this.machine.getStateNodeById(historyConfig.target).path.slice(this.path.length - 1)) : historyConfig.target;\n        } else {\n          target = historyConfig.target;\n        }\n      }\n\n      return target;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Returns the leaf nodes from a state path relative to this state node.\r\n   *\r\n   * @param relativeStateId The relative state path to retrieve the state nodes\r\n   * @param history The previous state to retrieve history\r\n   * @param resolve Whether state nodes should resolve to initial child state nodes\r\n   */\n\n  StateNode.prototype.getRelativeStateNodes = function (relativeStateId, historyValue, resolve) {\n    if (resolve === void 0) {\n      resolve = true;\n    }\n\n    return resolve ? relativeStateId.type === 'history' ? relativeStateId.resolveHistory(historyValue) : relativeStateId.initialStateNodes : [relativeStateId];\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateNodes\", {\n    get: function () {\n      var _this = this;\n\n      if (isLeafNode(this)) {\n        return [this];\n      } // Case when state node is compound but no initial state is defined\n\n\n      if (this.type === 'compound' && !this.initial) {\n        if (!IS_PRODUCTION) {\n          warn(false, \"Compound state node '\" + this.id + \"' has no initial state.\");\n        }\n\n        return [this];\n      }\n\n      var initialStateNodePaths = toStatePaths(this.initialStateValue);\n      return flatten(initialStateNodePaths.map(function (initialPath) {\n        return _this.getFromRelativePath(initialPath);\n      }));\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Retrieves state nodes from a relative path to this state node.\r\n   *\r\n   * @param relativePath The relative path from this state node\r\n   * @param historyValue\r\n   */\n\n  StateNode.prototype.getFromRelativePath = function (relativePath) {\n    if (!relativePath.length) {\n      return [this];\n    }\n\n    var _a = __read(relativePath),\n        stateKey = _a[0],\n        childStatePath = _a.slice(1);\n\n    if (!this.states) {\n      throw new Error(\"Cannot retrieve subPath '\" + stateKey + \"' from node with no states\");\n    }\n\n    var childStateNode = this.getStateNode(stateKey);\n\n    if (childStateNode.type === 'history') {\n      return childStateNode.resolveHistory();\n    }\n\n    if (!this.states[stateKey]) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return this.states[stateKey].getFromRelativePath(childStatePath);\n  };\n\n  StateNode.prototype.historyValue = function (relativeStateValue) {\n    if (!keys(this.states).length) {\n      return undefined;\n    }\n\n    return {\n      current: relativeStateValue || this.initialStateValue,\n      states: mapFilterValues(this.states, function (stateNode, key) {\n        if (!relativeStateValue) {\n          return stateNode.historyValue();\n        }\n\n        var subStateValue = isString(relativeStateValue) ? undefined : relativeStateValue[key];\n        return stateNode.historyValue(subStateValue || stateNode.initialStateValue);\n      }, function (stateNode) {\n        return !stateNode.history;\n      })\n    };\n  };\n  /**\r\n   * Resolves to the historical value(s) of the parent state node,\r\n   * represented by state nodes.\r\n   *\r\n   * @param historyValue\r\n   */\n\n\n  StateNode.prototype.resolveHistory = function (historyValue) {\n    var _this = this;\n\n    if (this.type !== 'history') {\n      return [this];\n    }\n\n    var parent = this.parent;\n\n    if (!historyValue) {\n      var historyTarget = this.target;\n      return historyTarget ? flatten(toStatePaths(historyTarget).map(function (relativeChildPath) {\n        return parent.getFromRelativePath(relativeChildPath);\n      })) : parent.initialStateNodes;\n    }\n\n    var subHistoryValue = nestedPath(parent.path, 'states')(historyValue).current;\n\n    if (isString(subHistoryValue)) {\n      return [parent.getStateNode(subHistoryValue)];\n    }\n\n    return flatten(toStatePaths(subHistoryValue).map(function (subStatePath) {\n      return _this.history === 'deep' ? parent.getFromRelativePath(subStatePath) : [parent.states[subStatePath[0]]];\n    }));\n  };\n\n  Object.defineProperty(StateNode.prototype, \"stateIds\", {\n    /**\r\n     * All the state node IDs of this state node and its descendant state nodes.\r\n     */\n    get: function () {\n      var _this = this;\n\n      var childStateIds = flatten(keys(this.states).map(function (stateKey) {\n        return _this.states[stateKey].stateIds;\n      }));\n      return [this.id].concat(childStateIds);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"events\", {\n    /**\r\n     * All the event types accepted by this state node and its descendants.\r\n     */\n    get: function () {\n      var e_7, _a, e_8, _b;\n\n      if (this.__cache.events) {\n        return this.__cache.events;\n      }\n\n      var states = this.states;\n      var events = new Set(this.ownEvents);\n\n      if (states) {\n        try {\n          for (var _c = __values(keys(states)), _d = _c.next(); !_d.done; _d = _c.next()) {\n            var stateId = _d.value;\n            var state = states[stateId];\n\n            if (state.states) {\n              try {\n                for (var _e = (e_8 = void 0, __values(state.events)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                  var event_1 = _f.value;\n                  events.add(\"\" + event_1);\n                }\n              } catch (e_8_1) {\n                e_8 = {\n                  error: e_8_1\n                };\n              } finally {\n                try {\n                  if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                } finally {\n                  if (e_8) throw e_8.error;\n                }\n              }\n            }\n          }\n        } catch (e_7_1) {\n          e_7 = {\n            error: e_7_1\n          };\n        } finally {\n          try {\n            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n          } finally {\n            if (e_7) throw e_7.error;\n          }\n        }\n      }\n\n      return this.__cache.events = Array.from(events);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"ownEvents\", {\n    /**\r\n     * All the events that have transitions directly from this state node.\r\n     *\r\n     * Excludes any inert events.\r\n     */\n    get: function () {\n      var events = new Set(this.transitions.filter(function (transition) {\n        return !(!transition.target && !transition.actions.length && transition.internal);\n      }).map(function (transition) {\n        return transition.eventType;\n      }));\n      return Array.from(events);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  StateNode.prototype.resolveTarget = function (_target) {\n    var _this = this;\n\n    if (_target === undefined) {\n      // an undefined target signals that the state node should not transition from that state when receiving that event\n      return undefined;\n    }\n\n    return _target.map(function (target) {\n      if (!isString(target)) {\n        return target;\n      }\n\n      var isInternalTarget = target[0] === _this.delimiter; // If internal target is defined on machine,\n      // do not include machine key on target\n\n      if (isInternalTarget && !_this.parent) {\n        return _this.getStateNodeByPath(target.slice(1));\n      }\n\n      var resolvedTarget = isInternalTarget ? _this.key + target : target;\n\n      if (_this.parent) {\n        try {\n          var targetStateNode = _this.parent.getStateNodeByPath(resolvedTarget);\n\n          return targetStateNode;\n        } catch (err) {\n          throw new Error(\"Invalid transition definition for state node '\" + _this.id + \"':\\n\" + err.message);\n        }\n      } else {\n        return _this.getStateNodeByPath(resolvedTarget);\n      }\n    });\n  };\n\n  StateNode.prototype.formatTransition = function (transitionConfig) {\n    var _this = this;\n\n    var normalizedTarget = normalizeTarget(transitionConfig.target);\n    var internal = 'internal' in transitionConfig ? transitionConfig.internal : normalizedTarget ? normalizedTarget.some(function (_target) {\n      return isString(_target) && _target[0] === _this.delimiter;\n    }) : true;\n    var guards = this.machine.options.guards;\n    var target = this.resolveTarget(normalizedTarget);\n\n    var transition = __assign(__assign({}, transitionConfig), {\n      actions: toActionObjects(toArray(transitionConfig.actions)),\n      cond: toGuard(transitionConfig.cond, guards),\n      target: target,\n      source: this,\n      internal: internal,\n      eventType: transitionConfig.event\n    });\n\n    Object.defineProperty(transition, 'toJSON', {\n      value: function () {\n        return __assign(__assign({}, transition), {\n          target: transition.target ? transition.target.map(function (t) {\n            return \"#\" + t.id;\n          }) : undefined,\n          source: \"#{this.id}\"\n        });\n      }\n    });\n    return transition;\n  };\n\n  StateNode.prototype.formatTransitions = function () {\n    var e_9, _a;\n\n    var _this = this;\n\n    var onConfig;\n\n    if (!this.config.on) {\n      onConfig = [];\n    } else if (Array.isArray(this.config.on)) {\n      onConfig = this.config.on;\n    } else {\n      var _b = this.config.on,\n          _c = WILDCARD,\n          _d = _b[_c],\n          wildcardConfigs = _d === void 0 ? [] : _d,\n          strictOnConfigs_1 = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n      onConfig = flatten(keys(strictOnConfigs_1).map(function (key) {\n        var arrayified = toTransitionConfigArray(key, strictOnConfigs_1[key]);\n\n        if (!IS_PRODUCTION) {\n          validateArrayifiedTransitions(_this, key, arrayified);\n        }\n\n        return arrayified;\n      }).concat(toTransitionConfigArray(WILDCARD, wildcardConfigs)));\n    }\n\n    var doneConfig = this.config.onDone ? toTransitionConfigArray(String(done(this.id)), this.config.onDone) : [];\n    var invokeConfig = flatten(this.invoke.map(function (invokeDef) {\n      var settleTransitions = [];\n\n      if (invokeDef.onDone) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(doneInvoke(invokeDef.id)), invokeDef.onDone)));\n      }\n\n      if (invokeDef.onError) {\n        settleTransitions.push.apply(settleTransitions, __spread(toTransitionConfigArray(String(error(invokeDef.id)), invokeDef.onError)));\n      }\n\n      return settleTransitions;\n    }));\n    var delayedTransitions = this.after;\n    var formattedTransitions = flatten(__spread(doneConfig, invokeConfig, onConfig).map(function (transitionConfig) {\n      return toArray(transitionConfig).map(function (transition) {\n        return _this.formatTransition(transition);\n      });\n    }));\n\n    try {\n      for (var delayedTransitions_1 = __values(delayedTransitions), delayedTransitions_1_1 = delayedTransitions_1.next(); !delayedTransitions_1_1.done; delayedTransitions_1_1 = delayedTransitions_1.next()) {\n        var delayedTransition = delayedTransitions_1_1.value;\n        formattedTransitions.push(delayedTransition);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (delayedTransitions_1_1 && !delayedTransitions_1_1.done && (_a = delayedTransitions_1.return)) _a.call(delayedTransitions_1);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    return formattedTransitions;\n  };\n\n  return StateNode;\n}();\n\nexport { StateNode };","import { StateNode } from './StateNode.js';\n\nfunction Machine(config, options, initialContext) {\n  if (initialContext === void 0) {\n    initialContext = config.context;\n  }\n\n  var resolvedInitialContext = typeof initialContext === 'function' ? initialContext() : initialContext;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nfunction createMachine(config, options) {\n  var resolvedInitialContext = typeof config.context === 'function' ? config.context() : config.context;\n  return new StateNode(config, options, resolvedInitialContext);\n}\n\nexport { Machine, createMachine };","import { __assign } from './_virtual/_tslib.js';\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };","var children = /*#__PURE__*/new Map();\nvar sessionIdIndex = 0;\nvar registry = {\n  bookId: function () {\n    return \"x:\" + sessionIdIndex++;\n  },\n  register: function (id, actor) {\n    children.set(id, actor);\n    return id;\n  },\n  get: function (id) {\n    return children.get(id);\n  },\n  free: function (id) {\n    children.delete(id);\n  }\n};\nexport { registry };","import { IS_PRODUCTION } from './environment.js';\n\nfunction getDevTools() {\n  var w = window;\n\n  if (!!w.__xstate__) {\n    return w.__xstate__;\n  }\n\n  return undefined;\n}\n\nfunction registerService(service) {\n  if (IS_PRODUCTION || typeof window === 'undefined') {\n    return;\n  }\n\n  var devTools = getDevTools();\n\n  if (devTools) {\n    devTools.register(service);\n  }\n}\n\nexport { registerService };","import { __values, __assign, __spread } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { warn, mapContext, isFunction, keys, toSCXMLEvent, isPromiseLike, isObservable, isMachine, reportUnhandledExceptionOnInvocation, symbolObservable, isArray, toEventObject, isString, uniqueId } from './utils.js';\nimport { ActionTypes, SpecialTargets } from './types.js';\nimport { isInFinalState } from './stateUtils.js';\nimport { errorPlatform, log, stop, start, cancel, send, update, error as error$1 } from './actionTypes.js';\nimport { doneInvoke, initEvent, getActionFunction, error } from './actions.js';\nimport { isState, State, bindActionToState } from './State.js';\nimport { isActor } from './Actor.js';\nimport { Scheduler } from './scheduler.js';\nimport { registry } from './registry.js';\nimport { registerService } from './devTools.js';\nvar DEFAULT_SPAWN_OPTIONS = {\n  sync: false,\n  autoForward: false\n};\n/**\r\n * Maintains a stack of the current service in scope.\r\n * This is used to provide the correct service to spawn().\r\n *\r\n * @private\r\n */\n\nvar withServiceScope = /*#__PURE__*/function () {\n  var serviceStack = [];\n  return function (service, fn) {\n    service && serviceStack.push(service);\n    var result = fn(service || serviceStack[serviceStack.length - 1]);\n    service && serviceStack.pop();\n    return result;\n  };\n}();\n\nvar InterpreterStatus;\n\n(function (InterpreterStatus) {\n  InterpreterStatus[InterpreterStatus[\"NotStarted\"] = 0] = \"NotStarted\";\n  InterpreterStatus[InterpreterStatus[\"Running\"] = 1] = \"Running\";\n  InterpreterStatus[InterpreterStatus[\"Stopped\"] = 2] = \"Stopped\";\n})(InterpreterStatus || (InterpreterStatus = {}));\n\nvar Interpreter =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new Interpreter instance (i.e., service) for the given machine with the provided options, if any.\r\n   *\r\n   * @param machine The machine to be interpreted\r\n   * @param options Interpreter options\r\n   */\n  function Interpreter(machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = Interpreter.defaultOptions;\n    }\n\n    this.machine = machine;\n    this.scheduler = new Scheduler();\n    this.delayedEventsMap = {};\n    this.listeners = new Set();\n    this.contextListeners = new Set();\n    this.stopListeners = new Set();\n    this.doneListeners = new Set();\n    this.eventListeners = new Set();\n    this.sendListeners = new Set();\n    /**\r\n     * Whether the service is started.\r\n     */\n\n    this.initialized = false;\n    this._status = InterpreterStatus.NotStarted;\n    this.children = new Map();\n    this.forwardTo = new Set();\n    /**\r\n     * Alias for Interpreter.prototype.start\r\n     */\n\n    this.init = this.start;\n    /**\r\n     * Sends an event to the running interpreter to trigger a transition.\r\n     *\r\n     * An array of events (batched) can be sent as well, which will send all\r\n     * batched events to the running interpreter. The listeners will be\r\n     * notified only **once** when all events are processed.\r\n     *\r\n     * @param event The event(s) to send\r\n     */\n\n    this.send = function (event, payload) {\n      if (isArray(event)) {\n        _this.batch(event);\n\n        return _this.state;\n      }\n\n      var _event = toSCXMLEvent(toEventObject(event, payload));\n\n      if (_this._status === InterpreterStatus.Stopped) {\n        // do nothing\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to stopped service \\\"\" + _this.machine.id + \"\\\". This service has already reached its final state, and will not transition.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n\n        return _this.state;\n      }\n\n      if (_this._status === InterpreterStatus.NotStarted && _this.options.deferEvents) {\n        // tslint:disable-next-line:no-console\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\" and is deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n      } else if (_this._status !== InterpreterStatus.Running) {\n        throw new Error(\"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\\nEvent: \" + JSON.stringify(_event.data));\n      }\n\n      _this.scheduler.schedule(function () {\n        // Forward copy of event to child actors\n        _this.forward(_event);\n\n        var nextState = _this.nextState(_event);\n\n        _this.update(nextState, _event);\n      });\n\n      return _this._state; // TODO: deprecate (should return void)\n      // tslint:disable-next-line:semicolon\n    };\n\n    this.sendTo = function (event, to) {\n      var isParent = _this.parent && (to === SpecialTargets.Parent || _this.parent.id === to);\n      var target = isParent ? _this.parent : isActor(to) ? to : _this.children.get(to) || registry.get(to);\n\n      if (!target) {\n        if (!isParent) {\n          throw new Error(\"Unable to send event to child '\" + to + \"' from service '\" + _this.id + \"'.\");\n        } // tslint:disable-next-line:no-console\n\n\n        if (!IS_PRODUCTION) {\n          warn(false, \"Service '\" + _this.id + \"' has no parent: unable to send event \" + event.type);\n        }\n\n        return;\n      }\n\n      if ('machine' in target) {\n        // Send SCXML events to machines\n        target.send(__assign(__assign({}, event), {\n          name: event.name === error$1 ? \"\" + error(_this.id) : event.name,\n          origin: _this.sessionId\n        }));\n      } else {\n        // Send normal events to other targets\n        target.send(event.data);\n      }\n    };\n\n    var resolvedOptions = __assign(__assign({}, Interpreter.defaultOptions), options);\n\n    var clock = resolvedOptions.clock,\n        logger = resolvedOptions.logger,\n        parent = resolvedOptions.parent,\n        id = resolvedOptions.id;\n    var resolvedId = id !== undefined ? id : machine.id;\n    this.id = resolvedId;\n    this.logger = logger;\n    this.clock = clock;\n    this.parent = parent;\n    this.options = resolvedOptions;\n    this.scheduler = new Scheduler({\n      deferEvents: this.options.deferEvents\n    });\n    this.sessionId = registry.bookId();\n  }\n\n  Object.defineProperty(Interpreter.prototype, \"initialState\", {\n    get: function () {\n      var _this = this;\n\n      if (this._initialState) {\n        return this._initialState;\n      }\n\n      return withServiceScope(this, function () {\n        _this._initialState = _this.machine.initialState;\n        return _this._initialState;\n      });\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Interpreter.prototype, \"state\", {\n    get: function () {\n      if (!IS_PRODUCTION) {\n        warn(this._status !== InterpreterStatus.NotStarted, \"Attempted to read state from uninitialized service '\" + this.id + \"'. Make sure the service is started first.\");\n      }\n\n      return this._state;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Executes the actions of the given state, with that state's `context` and `event`.\r\n   *\r\n   * @param state The state whose actions will be executed\r\n   * @param actionsConfig The action implementations to use\r\n   */\n\n  Interpreter.prototype.execute = function (state, actionsConfig) {\n    var e_1, _a;\n\n    try {\n      for (var _b = __values(state.actions), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var action = _c.value;\n        this.exec(action, state, actionsConfig);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.update = function (state, _event) {\n    var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\n\n    var _this = this; // Attach session ID to state\n\n\n    state._sessionid = this.sessionId; // Update state\n\n    this._state = state; // Execute actions\n\n    if (this.options.execute) {\n      this.execute(this.state);\n    } // Dev tools\n\n\n    if (this.devTools) {\n      this.devTools.send(_event.data, state);\n    } // Execute listeners\n\n\n    if (state.event) {\n      try {\n        for (var _e = __values(this.eventListeners), _f = _e.next(); !_f.done; _f = _e.next()) {\n          var listener = _f.value;\n          listener(state.event);\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    try {\n      for (var _g = __values(this.listeners), _h = _g.next(); !_h.done; _h = _g.next()) {\n        var listener = _h.value;\n        listener(state, state.event);\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    try {\n      for (var _j = __values(this.contextListeners), _k = _j.next(); !_k.done; _k = _j.next()) {\n        var contextListener = _k.value;\n        contextListener(this.state.context, this.state.history ? this.state.history.context : undefined);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_k && !_k.done && (_c = _j.return)) _c.call(_j);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    var isDone = isInFinalState(state.configuration || [], this.machine);\n\n    if (this.state.configuration && isDone) {\n      // get final child state node\n      var finalChildStateNode = state.configuration.find(function (sn) {\n        return sn.type === 'final' && sn.parent === _this.machine;\n      });\n      var doneData = finalChildStateNode && finalChildStateNode.data ? mapContext(finalChildStateNode.data, state.context, _event) : undefined;\n\n      try {\n        for (var _l = __values(this.doneListeners), _m = _l.next(); !_m.done; _m = _l.next()) {\n          var listener = _m.value;\n          listener(doneInvoke(this.id, doneData));\n        }\n      } catch (e_5_1) {\n        e_5 = {\n          error: e_5_1\n        };\n      } finally {\n        try {\n          if (_m && !_m.done && (_d = _l.return)) _d.call(_l);\n        } finally {\n          if (e_5) throw e_5.error;\n        }\n      }\n\n      this.stop();\n    }\n  };\n  /*\r\n   * Adds a listener that is notified whenever a state transition happens. The listener is called with\r\n   * the next state and the event object that caused the state transition.\r\n   *\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onTransition = function (listener) {\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state, this.state.event);\n    }\n\n    return this;\n  };\n\n  Interpreter.prototype.subscribe = function (nextListenerOrObserver, // @ts-ignore\n  errorListener, completeListener) {\n    var _this = this;\n\n    if (!nextListenerOrObserver) {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    }\n\n    var listener;\n    var resolvedCompleteListener = completeListener;\n\n    if (typeof nextListenerOrObserver === 'function') {\n      listener = nextListenerOrObserver;\n    } else {\n      listener = nextListenerOrObserver.next.bind(nextListenerOrObserver);\n      resolvedCompleteListener = nextListenerOrObserver.complete.bind(nextListenerOrObserver);\n    }\n\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this._status === InterpreterStatus.Running) {\n      listener(this.state);\n    }\n\n    if (resolvedCompleteListener) {\n      this.onDone(resolvedCompleteListener);\n    }\n\n    return {\n      unsubscribe: function () {\n        listener && _this.listeners.delete(listener);\n        resolvedCompleteListener && _this.doneListeners.delete(resolvedCompleteListener);\n      }\n    };\n  };\n  /**\r\n   * Adds an event listener that is notified whenever an event is sent to the running interpreter.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onEvent = function (listener) {\n    this.eventListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds an event listener that is notified whenever a `send` event occurs.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onSend = function (listener) {\n    this.sendListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a context listener that is notified whenever the state context changes.\r\n   * @param listener The context listener\r\n   */\n\n\n  Interpreter.prototype.onChange = function (listener) {\n    this.contextListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a listener that is notified when the machine is stopped.\r\n   * @param listener The listener\r\n   */\n\n\n  Interpreter.prototype.onStop = function (listener) {\n    this.stopListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a state listener that is notified when the statechart has reached its final state.\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onDone = function (listener) {\n    this.doneListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Removes a listener.\r\n   * @param listener The listener to remove\r\n   */\n\n\n  Interpreter.prototype.off = function (listener) {\n    this.listeners.delete(listener);\n    this.eventListeners.delete(listener);\n    this.sendListeners.delete(listener);\n    this.stopListeners.delete(listener);\n    this.doneListeners.delete(listener);\n    this.contextListeners.delete(listener);\n    return this;\n  };\n  /**\r\n   * Starts the interpreter from the given state, or the initial state.\r\n   * @param initialState The state to start the statechart from\r\n   */\n\n\n  Interpreter.prototype.start = function (initialState) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.Running) {\n      // Do not restart the service if it is already started\n      return this;\n    }\n\n    registry.register(this.sessionId, this);\n    this.initialized = true;\n    this._status = InterpreterStatus.Running;\n    var resolvedState = initialState === undefined ? this.initialState : withServiceScope(this, function () {\n      return isState(initialState) ? _this.machine.resolveState(initialState) : _this.machine.resolveState(State.from(initialState, _this.machine.context));\n    });\n\n    if (this.options.devTools) {\n      this.attachDev();\n    }\n\n    this.scheduler.initialize(function () {\n      _this.update(resolvedState, initEvent);\n    });\n    return this;\n  };\n  /**\r\n   * Stops the interpreter and unsubscribe all listeners.\r\n   *\r\n   * This will also notify the `onStop` listeners.\r\n   */\n\n\n  Interpreter.prototype.stop = function () {\n    var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;\n\n    try {\n      for (var _f = __values(this.listeners), _g = _f.next(); !_g.done; _g = _f.next()) {\n        var listener = _g.value;\n        this.listeners.delete(listener);\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_g && !_g.done && (_a = _f.return)) _a.call(_f);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    try {\n      for (var _h = __values(this.stopListeners), _j = _h.next(); !_j.done; _j = _h.next()) {\n        var listener = _j.value; // call listener, then remove\n\n        listener();\n        this.stopListeners.delete(listener);\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    try {\n      for (var _k = __values(this.contextListeners), _l = _k.next(); !_l.done; _l = _k.next()) {\n        var listener = _l.value;\n        this.contextListeners.delete(listener);\n      }\n    } catch (e_8_1) {\n      e_8 = {\n        error: e_8_1\n      };\n    } finally {\n      try {\n        if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n      } finally {\n        if (e_8) throw e_8.error;\n      }\n    }\n\n    try {\n      for (var _m = __values(this.doneListeners), _o = _m.next(); !_o.done; _o = _m.next()) {\n        var listener = _o.value;\n        this.doneListeners.delete(listener);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (_o && !_o.done && (_d = _m.return)) _d.call(_m);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    } // Stop all children\n\n\n    this.children.forEach(function (child) {\n      if (isFunction(child.stop)) {\n        child.stop();\n      }\n    });\n\n    try {\n      // Cancel all delayed events\n      for (var _p = __values(keys(this.delayedEventsMap)), _q = _p.next(); !_q.done; _q = _p.next()) {\n        var key = _q.value;\n        this.clock.clearTimeout(this.delayedEventsMap[key]);\n      }\n    } catch (e_10_1) {\n      e_10 = {\n        error: e_10_1\n      };\n    } finally {\n      try {\n        if (_q && !_q.done && (_e = _p.return)) _e.call(_p);\n      } finally {\n        if (e_10) throw e_10.error;\n      }\n    }\n\n    this.scheduler.clear();\n    this.initialized = false;\n    this._status = InterpreterStatus.Stopped;\n    registry.free(this.sessionId);\n    return this;\n  };\n\n  Interpreter.prototype.batch = function (events) {\n    var _this = this;\n\n    if (this._status === InterpreterStatus.NotStarted && this.options.deferEvents) {\n      // tslint:disable-next-line:no-console\n      if (!IS_PRODUCTION) {\n        warn(false, events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\" and are deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(event));\n      }\n    } else if (this._status !== InterpreterStatus.Running) {\n      throw new Error( // tslint:disable-next-line:max-line-length\n      events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\");\n    }\n\n    this.scheduler.schedule(function () {\n      var e_11, _a;\n\n      var nextState = _this.state;\n      var batchChanged = false;\n      var batchedActions = [];\n\n      var _loop_1 = function (event_1) {\n        var _event = toSCXMLEvent(event_1);\n\n        _this.forward(_event);\n\n        nextState = withServiceScope(_this, function () {\n          return _this.machine.transition(nextState, _event);\n        });\n        batchedActions.push.apply(batchedActions, __spread(nextState.actions.map(function (a) {\n          return bindActionToState(a, nextState);\n        })));\n        batchChanged = batchChanged || !!nextState.changed;\n      };\n\n      try {\n        for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {\n          var event_1 = events_1_1.value;\n\n          _loop_1(event_1);\n        }\n      } catch (e_11_1) {\n        e_11 = {\n          error: e_11_1\n        };\n      } finally {\n        try {\n          if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);\n        } finally {\n          if (e_11) throw e_11.error;\n        }\n      }\n\n      nextState.changed = batchChanged;\n      nextState.actions = batchedActions;\n\n      _this.update(nextState, toSCXMLEvent(events[events.length - 1]));\n    });\n  };\n  /**\r\n   * Returns a send function bound to this interpreter instance.\r\n   *\r\n   * @param event The event to be sent by the sender.\r\n   */\n\n\n  Interpreter.prototype.sender = function (event) {\n    return this.send.bind(this, event);\n  };\n  /**\r\n   * Returns the next state given the interpreter's current state and the event.\r\n   *\r\n   * This is a pure method that does _not_ update the interpreter's state.\r\n   *\r\n   * @param event The event to determine the next state\r\n   */\n\n\n  Interpreter.prototype.nextState = function (event) {\n    var _this = this;\n\n    var _event = toSCXMLEvent(event);\n\n    if (_event.name.indexOf(errorPlatform) === 0 && !this.state.nextEvents.some(function (nextEvent) {\n      return nextEvent.indexOf(errorPlatform) === 0;\n    })) {\n      throw _event.data.data;\n    }\n\n    var nextState = withServiceScope(this, function () {\n      return _this.machine.transition(_this.state, _event);\n    });\n    return nextState;\n  };\n\n  Interpreter.prototype.forward = function (event) {\n    var e_12, _a;\n\n    try {\n      for (var _b = __values(this.forwardTo), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var id = _c.value;\n        var child = this.children.get(id);\n\n        if (!child) {\n          throw new Error(\"Unable to forward event '\" + event + \"' from interpreter '\" + this.id + \"' to nonexistant child '\" + id + \"'.\");\n        }\n\n        child.send(event);\n      }\n    } catch (e_12_1) {\n      e_12 = {\n        error: e_12_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_12) throw e_12.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.defer = function (sendAction) {\n    var _this = this;\n\n    this.delayedEventsMap[sendAction.id] = this.clock.setTimeout(function () {\n      if (sendAction.to) {\n        _this.sendTo(sendAction._event, sendAction.to);\n      } else {\n        _this.send(sendAction._event);\n      }\n    }, sendAction.delay);\n  };\n\n  Interpreter.prototype.cancel = function (sendId) {\n    this.clock.clearTimeout(this.delayedEventsMap[sendId]);\n    delete this.delayedEventsMap[sendId];\n  };\n\n  Interpreter.prototype.exec = function (action, state, actionFunctionMap) {\n    var context = state.context,\n        _event = state._event;\n    var actionOrExec = getActionFunction(action.type, actionFunctionMap) || action.exec;\n    var exec = isFunction(actionOrExec) ? actionOrExec : actionOrExec ? actionOrExec.exec : action.exec;\n\n    if (exec) {\n      try {\n        return exec(context, _event.data, {\n          action: action,\n          state: this.state,\n          _event: _event\n        });\n      } catch (err) {\n        if (this.parent) {\n          this.parent.send({\n            type: 'xstate.error',\n            data: err\n          });\n        }\n\n        throw err;\n      }\n    }\n\n    switch (action.type) {\n      case send:\n        var sendAction = action;\n\n        if (typeof sendAction.delay === 'number') {\n          this.defer(sendAction);\n          return;\n        } else {\n          if (sendAction.to) {\n            this.sendTo(sendAction._event, sendAction.to);\n          } else {\n            this.send(sendAction._event);\n          }\n        }\n\n        break;\n\n      case cancel:\n        this.cancel(action.sendId);\n        break;\n\n      case start:\n        {\n          var activity = action.activity; // If the activity will be stopped right after it's started\n          // (such as in transient states)\n          // don't bother starting the activity.\n\n          if (!this.state.activities[activity.type]) {\n            break;\n          } // Invoked services\n\n\n          if (activity.type === ActionTypes.Invoke) {\n            var serviceCreator = this.machine.options.services ? this.machine.options.services[activity.src] : undefined;\n            var id = activity.id,\n                data = activity.data;\n\n            if (!IS_PRODUCTION) {\n              warn(!('forward' in activity), // tslint:disable-next-line:max-line-length\n              \"`forward` property is deprecated (found in invocation of '\" + activity.src + \"' in in machine '\" + this.machine.id + \"'). \" + \"Please use `autoForward` instead.\");\n            }\n\n            var autoForward = 'autoForward' in activity ? activity.autoForward : !!activity.forward;\n\n            if (!serviceCreator) {\n              // tslint:disable-next-line:no-console\n              if (!IS_PRODUCTION) {\n                warn(false, \"No service found for invocation '\" + activity.src + \"' in machine '\" + this.machine.id + \"'.\");\n              }\n\n              return;\n            }\n\n            var source = isFunction(serviceCreator) ? serviceCreator(context, _event.data) : serviceCreator;\n\n            if (isPromiseLike(source)) {\n              this.state.children[id] = this.spawnPromise(Promise.resolve(source), id);\n            } else if (isFunction(source)) {\n              this.state.children[id] = this.spawnCallback(source, id);\n            } else if (isObservable(source)) {\n              this.state.children[id] = this.spawnObservable(source, id);\n            } else if (isMachine(source)) {\n              // TODO: try/catch here\n              this.state.children[id] = this.spawnMachine(data ? source.withContext(mapContext(data, context, _event)) : source, {\n                id: id,\n                autoForward: autoForward\n              });\n            }\n          } else {\n            this.spawnActivity(activity);\n          }\n\n          break;\n        }\n\n      case stop:\n        {\n          this.stopChild(action.activity.id);\n          break;\n        }\n\n      case log:\n        var label = action.label,\n            value = action.value;\n\n        if (label) {\n          this.logger(label, value);\n        } else {\n          this.logger(value);\n        }\n\n        break;\n\n      default:\n        if (!IS_PRODUCTION) {\n          warn(false, \"No implementation found for action type '\" + action.type + \"'\");\n        }\n\n        break;\n    }\n\n    return undefined;\n  };\n\n  Interpreter.prototype.removeChild = function (childId) {\n    this.children.delete(childId);\n    this.forwardTo.delete(childId);\n    delete this.state.children[childId];\n  };\n\n  Interpreter.prototype.stopChild = function (childId) {\n    var child = this.children.get(childId);\n\n    if (!child) {\n      return;\n    }\n\n    this.removeChild(childId);\n\n    if (isFunction(child.stop)) {\n      child.stop();\n    }\n  };\n\n  Interpreter.prototype.spawn = function (entity, name, options) {\n    if (isPromiseLike(entity)) {\n      return this.spawnPromise(Promise.resolve(entity), name);\n    } else if (isFunction(entity)) {\n      return this.spawnCallback(entity, name);\n    } else if (isActor(entity)) {\n      return this.spawnActor(entity);\n    } else if (isObservable(entity)) {\n      return this.spawnObservable(entity, name);\n    } else if (isMachine(entity)) {\n      return this.spawnMachine(entity, __assign(__assign({}, options), {\n        id: name\n      }));\n    } else {\n      throw new Error(\"Unable to spawn entity \\\"\" + name + \"\\\" of type \\\"\" + typeof entity + \"\\\".\");\n    }\n  };\n\n  Interpreter.prototype.spawnMachine = function (machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var childService = new Interpreter(machine, __assign(__assign({}, this.options), {\n      parent: this,\n      id: options.id || machine.id\n    }));\n\n    var resolvedOptions = __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), options);\n\n    if (resolvedOptions.sync) {\n      childService.onTransition(function (state) {\n        _this.send(update, {\n          state: state,\n          id: childService.id\n        });\n      });\n    }\n\n    var actor = childService;\n    this.children.set(childService.id, actor);\n\n    if (resolvedOptions.autoForward) {\n      this.forwardTo.add(childService.id);\n    }\n\n    childService.onDone(function (doneEvent) {\n      _this.removeChild(childService.id);\n\n      _this.send(toSCXMLEvent(doneEvent, {\n        origin: childService.id\n      }));\n    }).start();\n    return actor;\n  };\n\n  Interpreter.prototype.spawnPromise = function (promise, id) {\n    var _this = this;\n\n    var canceled = false;\n    promise.then(function (response) {\n      if (!canceled) {\n        _this.removeChild(id);\n\n        _this.send(toSCXMLEvent(doneInvoke(id, response), {\n          origin: id\n        }));\n      }\n    }, function (errorData) {\n      if (!canceled) {\n        _this.removeChild(id);\n\n        var errorEvent = error(id, errorData);\n\n        try {\n          // Send \"error.platform.id\" to this (parent).\n          _this.send(toSCXMLEvent(errorEvent, {\n            origin: id\n          }));\n        } catch (error) {\n          reportUnhandledExceptionOnInvocation(errorData, error, id);\n\n          if (_this.devTools) {\n            _this.devTools.send(errorEvent, _this.state);\n          }\n\n          if (_this.machine.strict) {\n            // it would be better to always stop the state machine if unhandled\n            // exception/promise rejection happens but because we don't want to\n            // break existing code so enforce it on strict mode only especially so\n            // because documentation says that onError is optional\n            _this.stop();\n          }\n        }\n      }\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        var unsubscribed = false;\n        promise.then(function (response) {\n          if (unsubscribed) {\n            return;\n          }\n\n          next && next(response);\n\n          if (unsubscribed) {\n            return;\n          }\n\n          complete && complete();\n        }, function (err) {\n          if (unsubscribed) {\n            return;\n          }\n\n          handleError(err);\n        });\n        return {\n          unsubscribe: function () {\n            return unsubscribed = true;\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnCallback = function (callback, id) {\n    var _this = this;\n\n    var canceled = false;\n    var receivers = new Set();\n    var listeners = new Set();\n\n    var receive = function (e) {\n      listeners.forEach(function (listener) {\n        return listener(e);\n      });\n\n      if (canceled) {\n        return;\n      }\n\n      _this.send(e);\n    };\n\n    var callbackStop;\n\n    try {\n      callbackStop = callback(receive, function (newListener) {\n        receivers.add(newListener);\n      });\n    } catch (err) {\n      this.send(error(id, err));\n    }\n\n    if (isPromiseLike(callbackStop)) {\n      // it turned out to be an async function, can't reliably check this before calling `callback`\n      // because transpiled async functions are not recognizable\n      return this.spawnPromise(callbackStop, id);\n    }\n\n    var actor = {\n      id: id,\n      send: function (event) {\n        return receivers.forEach(function (receiver) {\n          return receiver(event);\n        });\n      },\n      subscribe: function (next) {\n        listeners.add(next);\n        return {\n          unsubscribe: function () {\n            listeners.delete(next);\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n\n        if (isFunction(callbackStop)) {\n          callbackStop();\n        }\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnObservable = function (source, id) {\n    var _this = this;\n\n    var subscription = source.subscribe(function (value) {\n      _this.send(toSCXMLEvent(value, {\n        origin: id\n      }));\n    }, function (err) {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(error(id, err), {\n        origin: id\n      }));\n    }, function () {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(doneInvoke(id), {\n        origin: id\n      }));\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        return source.subscribe(next, handleError, complete);\n      },\n      stop: function () {\n        return subscription.unsubscribe();\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActor = function (actor) {\n    this.children.set(actor.id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActivity = function (activity) {\n    var implementation = this.machine.options && this.machine.options.activities ? this.machine.options.activities[activity.type] : undefined;\n\n    if (!implementation) {\n      if (!IS_PRODUCTION) {\n        warn(false, \"No implementation found for activity '\" + activity.type + \"'\");\n      } // tslint:disable-next-line:no-console\n\n\n      return;\n    } // Start implementation\n\n\n    var dispose = implementation(this.state.context, activity);\n    this.spawnEffect(activity.id, dispose);\n  };\n\n  Interpreter.prototype.spawnEffect = function (id, dispose) {\n    this.children.set(id, {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function () {\n        return {\n          unsubscribe: function () {\n            return void 0;\n          }\n        };\n      },\n      stop: dispose || undefined,\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    });\n  };\n\n  Interpreter.prototype.attachDev = function () {\n    if (this.options.devTools && typeof window !== 'undefined') {\n      if (window.__REDUX_DEVTOOLS_EXTENSION__) {\n        var devToolsOptions = typeof this.options.devTools === 'object' ? this.options.devTools : undefined;\n        this.devTools = window.__REDUX_DEVTOOLS_EXTENSION__.connect(__assign(__assign({\n          name: this.id,\n          autoPause: true,\n          stateSanitizer: function (state) {\n            return {\n              value: state.value,\n              context: state.context,\n              actions: state.actions\n            };\n          }\n        }, devToolsOptions), {\n          features: __assign({\n            jump: false,\n            skip: false\n          }, devToolsOptions ? devToolsOptions.features : undefined)\n        }), this.machine);\n        this.devTools.init(this.state);\n      } // add XState-specific dev tooling hook\n\n\n      registerService(this);\n    }\n  };\n\n  Interpreter.prototype.toJSON = function () {\n    return {\n      id: this.id\n    };\n  };\n\n  Interpreter.prototype[symbolObservable] = function () {\n    return this;\n  };\n  /**\r\n   * The default interpreter options:\r\n   *\r\n   * - `clock` uses the global `setTimeout` and `clearTimeout` functions\r\n   * - `logger` uses the global `console.log()` method\r\n   */\n\n\n  Interpreter.defaultOptions = /*#__PURE__*/function (global) {\n    return {\n      execute: true,\n      deferEvents: true,\n      clock: {\n        setTimeout: function (fn, ms) {\n          return global.setTimeout.call(null, fn, ms);\n        },\n        clearTimeout: function (id) {\n          return global.clearTimeout.call(null, id);\n        }\n      },\n      logger: global.console.log.bind(console),\n      devTools: false\n    };\n  }(typeof window === 'undefined' ? global : window);\n\n  Interpreter.interpret = interpret;\n  return Interpreter;\n}();\n\nvar createNullActor = function (name) {\n  if (name === void 0) {\n    name = 'null';\n  }\n\n  return {\n    id: name,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      // tslint:disable-next-line:no-empty\n      return {\n        unsubscribe: function () {}\n      };\n    },\n    toJSON: function () {\n      return {\n        id: name\n      };\n    }\n  };\n};\n\nvar resolveSpawnOptions = function (nameOrOptions) {\n  if (isString(nameOrOptions)) {\n    return __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n      name: nameOrOptions\n    });\n  }\n\n  return __assign(__assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n    name: uniqueId()\n  }), nameOrOptions);\n};\n\nfunction spawn(entity, nameOrOptions) {\n  var resolvedOptions = resolveSpawnOptions(nameOrOptions);\n  return withServiceScope(undefined, function (service) {\n    if (!IS_PRODUCTION) {\n      warn(!!service, \"Attempted to spawn an Actor (ID: \\\"\" + (isMachine(entity) ? entity.id : 'undefined') + \"\\\") outside of a service. This will have no effect.\");\n    }\n\n    if (service) {\n      return service.spawn(entity, resolvedOptions.name, resolvedOptions);\n    } else {\n      return createNullActor(resolvedOptions.name);\n    }\n  });\n}\n/**\r\n * Creates a new Interpreter instance for the given machine with the provided options, if any.\r\n *\r\n * @param machine The machine to interpret\r\n * @param options Interpreter options\r\n */\n\n\nfunction interpret(machine, options) {\n  var interpreter = new Interpreter(machine, options);\n  return interpreter;\n}\n\nexport { Interpreter, interpret, spawn };","import { __values, __read } from './_virtual/_tslib.js';\nimport { State } from './State.js';\n\nfunction matchState(state, patterns, defaultValue) {\n  var e_1, _a;\n\n  var resolvedState = State.from(state, state instanceof State ? state.context : undefined);\n\n  try {\n    for (var patterns_1 = __values(patterns), patterns_1_1 = patterns_1.next(); !patterns_1_1.done; patterns_1_1 = patterns_1.next()) {\n      var _b = __read(patterns_1_1.value, 2),\n          stateValue = _b[0],\n          getValue = _b[1];\n\n      if (resolvedState.matches(stateValue)) {\n        return getValue(resolvedState);\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (patterns_1_1 && !patterns_1_1.done && (_a = patterns_1.return)) _a.call(patterns_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return defaultValue(resolvedState);\n}\n\nexport { matchState };","export { matchesState } from './utils.js';\nexport { mapState } from './mapState.js';\nexport { ActionTypes, SpecialTargets } from './types.js';\nimport { raise, send, sendParent, sendUpdate, log, cancel, start, stop, assign, after, done, respond, forwardTo, escalate, choose, pure } from './actions.js';\nexport { assign, doneInvoke, forwardTo, send, sendParent, sendUpdate } from './actions.js';\nexport { State } from './State.js';\nexport { StateNode } from './StateNode.js';\nexport { Machine, createMachine } from './Machine.js';\nexport { Interpreter, interpret, spawn } from './interpreter.js';\nexport { matchState } from './match.js';\nvar actions = {\n  raise: raise,\n  send: send,\n  sendParent: sendParent,\n  sendUpdate: sendUpdate,\n  log: log,\n  cancel: cancel,\n  start: start,\n  stop: stop,\n  assign: assign,\n  after: after,\n  done: done,\n  respond: respond,\n  forwardTo: forwardTo,\n  escalate: escalate,\n  choose: choose,\n  pure: pure\n};\nexport { actions };","import { createMachine, assign, interpret } from \"xstate\";\r\n\r\nconst elBox = document.querySelector(\"#box\");\r\n\r\nconst randomFetch = () => {\r\n    return new Promise((res, rej) => {\r\n        setTimeout(() => {\r\n            if (Math.random() < 0.5) {\r\n                rej(\"Fetch failed!\");\r\n            } else {\r\n                res(\"Fetch succeeded!\");\r\n            }\r\n        }, 2000);\r\n    });\r\n};\r\n\r\nconst machine = createMachine({\r\n    initial: \"idle\",\r\n    states: {\r\n        idle: {\r\n            on: {\r\n                FETCH: {\r\n                    target: \"pending\",\r\n                },\r\n            },\r\n        },\r\n        pending: {\r\n            on: {\r\n                RESOLVE: \"resolved\",\r\n            },\r\n            invoke: {\r\n                // Invoke your promise here.\r\n                // The `src` should be a function that returns the source.\r\n                invoke: {\r\n                    src: (context, event) => {\r\n                        return randomFetch();\r\n                    },\r\n                    onDone: {\r\n                        target: \"resolved\",\r\n                        actions: (_, event) => {\r\n                            console.log(event);\r\n                        },\r\n                    },\r\n                    onError: {\r\n                        target: \"rejected\",\r\n                    },\r\n                },\r\n            },\r\n        },\r\n        resolved: {\r\n            // Add a transition to fetch again\r\n            on: {\r\n                FETCH: \"pending\",\r\n            },\r\n        },\r\n        rejected: {\r\n            // Add a transition to fetch again\r\n            on: {\r\n                FETCH: \"pending\",\r\n            },\r\n        },\r\n    },\r\n});\r\n\r\nconst service = interpret(machine);\r\n\r\nservice.onTransition((state) => {\r\n    elBox.dataset.state = state.toStrings().join(\" \");\r\n\r\n    console.log(state);\r\n});\r\n\r\nservice.start();\r\n\r\nelBox.addEventListener(\"click\", (event) => {\r\n    service.send(\"FETCH\");\r\n});\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}